<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>פרוייקט “התלמיד והמחשב”, בעיה 25 | לא מדויק</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="פרוייקט “התלמיד והמחשב”, בעיה 25" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="סוף סוף הגענו אל בעיה עם בשר אמיתי, וכזו שתיתן לנו תירוץ להזכיר קצת מתמטיקה, ברמה יותר גבוהה מזו שהוזכרה בספר. נתחיל מהבעיה עצמה, שהיא פשוטה למדי לניסוח ולמרבה הצער, מנוסחת בלשון צבאית: בפלוגה כלשהי יש לנו 100 חיילים. מהם חלק הם טוראים, חלק הם סמלים וחלק הם קצינים. משכורתו של טוראי היא 1 ש”ח, משכורתו של סמל היא 10 ש”ח ומשכורתו של קצין היא 50 ש”ח. ידוע שסכום המשכורות של כל החיילים הוא 500 ש”ח. מה מספר הטוראים, מה מספר הסמלים ומה מספר הקצינים בפלוגה?" />
<meta property="og:description" content="סוף סוף הגענו אל בעיה עם בשר אמיתי, וכזו שתיתן לנו תירוץ להזכיר קצת מתמטיקה, ברמה יותר גבוהה מזו שהוזכרה בספר. נתחיל מהבעיה עצמה, שהיא פשוטה למדי לניסוח ולמרבה הצער, מנוסחת בלשון צבאית: בפלוגה כלשהי יש לנו 100 חיילים. מהם חלק הם טוראים, חלק הם סמלים וחלק הם קצינים. משכורתו של טוראי היא 1 ש”ח, משכורתו של סמל היא 10 ש”ח ומשכורתו של קצין היא 50 ש”ח. ידוע שסכום המשכורות של כל החיילים הוא 500 ש”ח. מה מספר הטוראים, מה מספר הסמלים ומה מספר הקצינים בפלוגה?" />
<link rel="canonical" href="http://gadial.net/2014/04/02/student_and_computer_25/" />
<meta property="og:url" content="http://gadial.net/2014/04/02/student_and_computer_25/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-04-02T18:18:48+00:00" />
<script type="application/ld+json">
{"dateModified":"2014-04-02T18:18:48+00:00","datePublished":"2014-04-02T18:18:48+00:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2014/04/02/student_and_computer_25/"},"url":"http://gadial.net/2014/04/02/student_and_computer_25/","description":"סוף סוף הגענו אל בעיה עם בשר אמיתי, וכזו שתיתן לנו תירוץ להזכיר קצת מתמטיקה, ברמה יותר גבוהה מזו שהוזכרה בספר. נתחיל מהבעיה עצמה, שהיא פשוטה למדי לניסוח ולמרבה הצער, מנוסחת בלשון צבאית: בפלוגה כלשהי יש לנו 100 חיילים. מהם חלק הם טוראים, חלק הם סמלים וחלק הם קצינים. משכורתו של טוראי היא 1 ש”ח, משכורתו של סמל היא 10 ש”ח ומשכורתו של קצין היא 50 ש”ח. ידוע שסכום המשכורות של כל החיילים הוא 500 ש”ח. מה מספר הטוראים, מה מספר הסמלים ומה מספר הקצינים בפלוגה?","headline":"פרוייקט “התלמיד והמחשב”, בעיה 25","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$latex','$'] ],
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/whats_going_on">מה הולך פה?</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">דף אקראי</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  
  <div class="PageNavigation">
    
      <a class="prev" href="/2014/03/29/student_and_computer_21-24/">&laquo; פרוייקט "התלמיד והמחשב", בעיות 21-24</a>
    
    
      <a class="next" href="/2014/04/04/lagrange_four_squares_theorem/">משפט ארבעת הריבועים של לגראנז' &raquo;</a>
    
  </div>

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">פרוייקט &quot;התלמיד והמחשב&quot;, בעיה 25</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2014-04-02T18:18:48+00:00" itemprop="datePublished">Apr 2, 2014
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>סוף סוף הגענו אל בעיה עם בשר אמיתי, וכזו שתיתן לנו תירוץ להזכיר קצת מתמטיקה, ברמה יותר גבוהה מזו שהוזכרה בספר. נתחיל מהבעיה עצמה, שהיא פשוטה למדי לניסוח ולמרבה הצער, מנוסחת בלשון צבאית: בפלוגה כלשהי יש לנו 100 חיילים. מהם חלק הם טוראים, חלק הם סמלים וחלק הם קצינים. משכורתו של טוראי היא 1 ש”ח, משכורתו של סמל היא 10 ש”ח ומשכורתו של קצין היא 50 ש”ח. ידוע שסכום המשכורות של כל החיילים הוא 500 ש”ח. מה מספר הטוראים, מה מספר הסמלים ומה מספר הקצינים בפלוגה?</p>

<p>למי שהניסוח הצבאי מעצבן אותו אפשר להשתמש בשלל סיפורי רקע אחרים. למשל, תערובת כימית שכוללת 100 אטומים של מימן (פרוטון אחד), נאון (10 פרוטונים) ובדיל (50 פרוטונים) וידוע שיש בה סה”כ 500 פרוטונים. נשאלת השאלה כמה אטומים יש מכל סוג (למעשה, שאלות מסוג זה הן אכן נפוצות הרבה יותר בהקשר של תערובות ותרכובות כימיות מאשר בהקשר הצבאי). בסופו של דבר אנחנו מקבלים את אותו פורמליזם מתמטי - מערכת משוואות לינארית שנראית כך:</p>

<p><span>$latex \array{x+y+z&amp;=&amp;100\\x+10y+50z&amp;=&amp;500}$</span></p>

<p>זו <strong>מערכת</strong> של משוואות כי היא כוללת שתי משוואות ולא אחת; וזו מערכת <strong>לינארית</strong> כי כל המשתנים שלנו - <span>$latex x,y,z$</span> - מופיעים בה כשהחזקה שלהם היא 1, ולא מפעילים עליהם פונקציות מוזרות כמו סינוס. הנה דוגמה למשוואות לא לינאריות: <span>$latex x^2+x+1=0$</span>  אינה לינארית כי ה-<span>$latex x$</span> הוא בריבוע, ו-<span>$latex \sin(x)=x$</span> אינה לינארית כי <span>$latex x$</span> מופיע פעם אחת כשמפעילים עליו את סינוס.</p>

<p>הסיבה שאנחנו טורחים לתת שם מיוחד למשוואות לינאריות היא שהמשוואות הללו <strong>פשוטות במיוחד</strong>. לפתור משוואות לא לינאריות בצורה מדוייקת זה לרוב קשה; אבל עבור משוואות לינאריות התיאוריה מאוד מפותחת ויש לנו שיטות פתרון נקיות ופשוטות למדי. לעתים קרובות האופן שבו מתמודדים עם מערכת משוואות לא לינאריות היא באמצעות קירוב שלהן בעזרת מערכת משוואות לינאריות שאותה אנחנו יודעים לפתור.</p>

<p>במקרה הפשוט ביותר, המערכת היא מעל <strong>שדה</strong>, כלומר אפשר לבצע על המספרים שלנו פעולות של חיבור, חיסור, כפל וחילוק. במקרה הזה אפשר להפעיל את מה שנקרא “חילוץ גאוסי” - אולי אחד הדברים הראשונים שסטודנטים למתמטיקה לומדים (בקורס אלגברה לינארית) שמוצא את כל הפתרונות למערכת, אם קיימים כאלו. צריך לשים דגש על המילה “פתרונות” - כבר בבית הספר לומדים שלמערכת עם שלושה נעלמים ושתי משוואות, כמו אצלנו, יכול להיות יותר מפתרון אחד.</p>

<p>אז מה הבעיה? הבעיה היא שלפעמים יש עוד <strong>אילוצים</strong> על הפתרונות, וכך גם אצלנו. ראשית, אנחנו מצפים שהפתרונות יהיו <strong>מספרים שלמים</strong>, מה שאומר שאם נפעיל את שיטת גאוס ונקבל פתרונות שהם שבר זה לא יהיה מספיק טוב. למשוואה שבה הפתרונות צריכים להיות שלמים קוראים <strong>משוואה דיופנטית</strong>, אז מה שיותר מדויק לומר הוא שאנחנו פותרים פה מערכת של משוואות דיופנטיות לינאריות. באופן כללי משוואות דיופנטיות הן דבר קשה ביותר לפתרון - כתבתי בשעתו <a href="http://www.gadial.net/2012/08/27/hilbert_tenth_intro/">סדרת פוסטים</a> שמוכיחה שלא קיים אלגוריתם שפותר מערכת משוואות דיופנטית כללית. אבל במערכת כזו יכולות להיות חזקות גדולות מ-1 של המשתנים, ואילו אצלנו מערכת המשוואות הדיופנטיות היא לינארית, ותמיד ניתן לפתור מערכת כזו ואסביר את הרעיון הכללי בהמשך.</p>

<p>עדיין, יש לנו עוד הגבלה על המערכת - כל הפתרונות צריכים להיות מספרים <strong>חיוביים</strong>. המגבלות הללו הן לא סוף העולם ואפשר להשתמש באלגוריתמים הכלליים לפתרון מערכות של משוואות; אבל צריך להבין ששימוש בהם עדיין לא יהיה סוף הסיפור. השיטות הכלליות יתנו לנו המון פתרונות אפשריים, ונצטרך לחפש בתוכם את הפתרון ה”נכון”. השיטות הכלליות גם יהיו קצת מסובכות מבחינת התיאוריה שמאחוריהן ואני לא מצפה שכל הקוראים יבינו אותן וישרדו עד הסוף.</p>

<p>על כן, לפני שניגש לפתרונות הכלליים, בואו נראה את הפתרון שיש בספר, שהוא פתרון “ברוטלי” למדי אבל לפעמים הוא גם הכי מתאים - פשוט נחפש בכוח שלשה של מספרים שהיא פתרון. אבל גם פתרון כוח גס שכזה צריך לדעת לממש. הנה דוגמה למימוש <strong>לא טוב</strong>:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">A</span> <span class="o">=</span> <span class="mi">1</span>
<span class="no">B</span> <span class="o">=</span> <span class="mi">10</span>
<span class="no">C</span> <span class="o">=</span> <span class="mi">50</span>
<span class="no">NUM</span> <span class="o">=</span> <span class="mi">100</span>
<span class="no">SUM</span> <span class="o">=</span> <span class="mi">500</span>

<span class="k">for</span> <span class="n">x</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">NUM</span><span class="p">)</span> <span class="k">do</span>
  <span class="k">for</span> <span class="n">y</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">NUM</span><span class="p">)</span> <span class="k">do</span>
    <span class="k">for</span> <span class="n">z</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">NUM</span><span class="p">)</span> <span class="k">do</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span> <span class="o">==</span> <span class="no">NUM</span> <span class="n">and</span> <span class="no">A</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="no">B</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="no">C</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="no">SUM</span><span class="p">)</span>
	<span class="nb">puts</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x</span> <span class="o">=</span> <span class="c1">#{x}, y = #{y}, z = #{z}&amp;quot;</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

</div>

<p>הפתרון הזה לא טוב לא בגלל שהוא לא עובד; הוא עובד, ועוצר תוך שניה ומחזיר את הפתרון הנכון (x = 60, y = 39, z = 1). הוא לא טוב כי הוא עושה עבודה מיותרת ולא עובר בצורה חכמה על המשתנים שלנו. ראשית, אין שום סיבה בעולם להשתמש ב<strong>שלוש</strong> לולאות for אחת בתוך השניה; אפשר להיעזר בכך שאנחנו יודעים ש-<span>$latex x+y+z=100$</span> ולכן אם כבר קבענו מי יהיו <span>$latex x,y$</span> אז אפשר להגדיר את <span>$latex z$</span> להיות 100 פחות שניהם:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">for</span> <span class="n">x</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">NUM</span><span class="p">)</span> <span class="k">do</span>
  <span class="k">for</span> <span class="n">y</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">NUM</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">z</span> <span class="o">=</span> <span class="no">NUM</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">0</span> <span class="n">and</span> <span class="no">A</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="no">B</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="no">C</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="no">SUM</span><span class="p">)</span>
      <span class="nb">puts</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x</span> <span class="o">=</span> <span class="c1">#{x}, y = #{y}, z = #{z}&amp;quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

</div>

<p>שימו לב שעכשיו אני נאלץ לבדוק אם z הוא חיובי כי הוא עלול לצאת שלילי. הסיבה לכך היא שלא הייתי חכם ואני נותן ל-y להיות כל מספר מ-0 ועד 100, גם אם הסכום של x ו-y יעבור את 100. אז בואו נגביל את y:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">for</span> <span class="n">x</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">NUM</span><span class="p">)</span> <span class="k">do</span>
  <span class="k">for</span> <span class="n">y</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="p">(</span><span class="no">NUM</span><span class="o">-</span><span class="n">x</span><span class="p">))</span> <span class="k">do</span>
    <span class="n">z</span> <span class="o">=</span> <span class="no">NUM</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="no">A</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="no">B</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="no">C</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="no">SUM</span><span class="p">)</span>
      <span class="nb">puts</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x</span> <span class="o">=</span> <span class="c1">#{x}, y = #{y}, z = #{z}&amp;quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

</div>

<p>עד כאן הכל די ברור. האופטימיזציה הבאה היא טיפה יותר חכמה, וכנראה הדבר הכי חשוב מבין כל האופטמיזציות שאני מראה פה. האבחנה היא שיש לי מגבלה נוספת ברורה על הגודל המקסימלי של x,y,z - המשוואה השניה. המשוואה השניה אומרת לי, למשל, ש-z חייב להיות בין 0 ל-10, אחרת כבר 50z לבדו יהיה גדול מ-500. לכן, במקום לרוץ על כל ערכי x מ-0 ועד 100, עדיף להתחיל דווקא מלרוץ על ערכי z, אחר כך לרוץ על ערכי y, ואת x כבר לקבוע מתוך שניהם. זה מוביל לפתרון הכי טוב שלי:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">for</span> <span class="n">z</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="no">SUM</span><span class="o">/</span><span class="no">C</span><span class="p">)</span> <span class="k">do</span>
  <span class="k">for</span> <span class="n">y</span> <span class="k">in</span> <span class="p">(</span><span class="mi">0</span><span class="o">..</span><span class="p">(</span><span class="no">SUM</span><span class="o">-</span><span class="no">C</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">x</span> <span class="o">=</span> <span class="no">NUM</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="no">A</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="no">B</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="no">C</span><span class="o">*</span><span class="n">z</span> <span class="o">==</span> <span class="no">SUM</span><span class="p">)</span>
      <span class="nb">puts</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x</span> <span class="o">=</span> <span class="c1">#{x}, y = #{y}, z = #{z}&amp;quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></figure>

</div>

<p>הפתרון הזה פחות קריא מהקודמים, אבל בהחלט יותר יעיל. עד כמה שאפשר לדבר על “יעילות” בהקשר הזה, שבו כל אחד מהסקריפטים שהצגתי מסיים לרוץ כהרף עין.</p>

<p>אז זה פתרון הכוח הגס. מה על פתרונות חכמים יותר, שמשתמשים בשיטות מתמטיות כלליות? ובכן, אפשר לממש את השיטות הללו באופן עצמאי, אבל זה לא רעיון טוב במיוחד - עבור רוב שפות התכנות יש ספריות מתמטיות שמומשו עם דגש על יעילות, ועדיף להשתמש בהן. למרבה הצער, רובי היא אחת מאותן שפות שבהן זה <strong>לא</strong> המצב. הספריה המתמטית שלה אינה מפותחת מספיק, ולמרות שעושים מאמצים בכיוון, אני מעדיף לנצל את ההזדמנות הזו ולקפוץ לרגע הצידה, אל האחות של רובי - פייתון.</p>

<p>בשורה התחתונה, פייתון ורובי הן שפות די דומות - שתיהן שפות סקריפטינג עם תחביר קליל יחסית (ודומה יחסית) ושתיהן רבות עוצמה ומאפשרות לעשות דברים מורכבים בפשטות יחסית, תוך תשלום של מחיר כלשהו בזמן הריצה. מצד שני, לפייתון יש יתרון מרכזי אחד על רובי - כמות גדולה יותר של משתמשים, ולכן קהילה גדולה יותר, סיכוי גדול יותר לקבל תמיכה אם נתקלים בבעיה, והכי חשוב - הרבה יותר ספריות. אפשר לומר בצחוק שיש ספריית פייתון לכל דבר בערך, וזה לא יהיה רחוק כל כך מהמציאות. הנה מה שהיה לרנדל מונרו מ-xkcd לומר כשהוא גילה את פייתון:</p>

<p><a href="/assets/img/2014/03/python.png"><img src="/assets/img/2014/03/python.png" alt="python" width="518" height="588" class="alignnone size-full wp-image-3088" /></a></p>

<p>בפרט, לפייתון יש תמיכה יפה מאוד בספריות מתמטיות. בואו נתחיל מלדבר על SymPy - ספריה למתמטיקה סימבולית, שזה בדיוק מה שאנחנו צריכים - פתרון משוואות אלגבריות עם נעלמים הוא סוג של מתמטיקה סימבולית. בואו נראה תוכנית בפייתון שפותרת את הבעיה שלנו עם התבססות על חילוץ גאוסי, ואסביר אותה שורה שורה:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s">'x y z'</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">([</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">50</span><span class="o">*</span><span class="n">z</span> <span class="o">-</span> <span class="mi">500</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="k">for</span> <span class="n">z_val</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
  <span class="n">x_val</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">z_val</span><span class="p">)</span>
  <span class="n">y_val</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">z_val</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">x_val</span><span class="o">.</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">y_val</span><span class="o">.</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x</span> <span class="o">=</span> <span class="o">%</span><span class="n">d</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">%</span><span class="n">d</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">z_val</span><span class="p">)</span></code></pre></figure>

</div>

<p>התחביר דומה מספיק לזה של רובי כדי שלא אבזבז זמן על הסברים שלו - אני מניח שגם מה שלא זהה הוא די ברור. בשורה 1 אני אומר לפייתון להשתמש בספריה של SymPy. בשורה 2 אני מגדיר שלושה סימבולים, x,y,z, ומציב אותם בתוך המשתנים שנקראים באותו שם (למרות שהם לא חייבים). שימו לב ש”סימבול” כאן הוא משהו שונה מסיבול של רובי - כאן סימבול הוא אובייקט של הספריה SymPy ולא קשור לסימבולים של רובי בשום צורה.</p>

<p>בשורה השלישית מתבצעת המתמטיקה - אני קורא לפונקציה solve שמקבלת כקלט מערך הכולל שתי משוואות. ההנחה הסמויה של SymPy הוא שאם אני כותב ביטוי כמו “x + y + z - 100” בלי שוויון בתוכו, אני מתכוון שהוא יהיה שווה ל-0. לכן הביטוי הזה מקודד את המשוואה “x + y + z = 100”. בדומה,  “x + 10<em>y + 50</em>z - 500” מקודד את המשוואה “x + 10<em>y + 50</em>z = 500”. מה ש-SymPy עושה הוא לזהות בעצמו שמדובר על משוואה לינארית ולקרוא למימוש שלו של האלגוריתם הגאוסי שמחזיר פתרון כללי למשוואה הזו מעל הרציונליים. ואם נסתכל מה הערך של sol בשלב הזה, זה מה שנראה:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">40</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">500</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="o">-</span><span class="mi">49</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">400</span><span class="o">/</span><span class="mi">9</span><span class="p">}</span></code></pre></figure>

</div>

<p>מה שיש לנו כאן הוא Hash שמכיל שני מפתחות: את הערך של x כפונקציה של z, ואת הערך של y כפונקציה של z. הנקודה פה היא שלכל ערך של z שרק נבחר, קיים פתרון (יחיד) למערכת המשוואות, ואם נציב את z בפונקציות שמגדירות את x,y נקבל את הערכים שלהם. למשל, אם נבחר z=1 נקבל <span>$latex x=\frac{40+500}{9}=60$</span> ו-<span>$latex y=\frac{-49+400}{9}=39$</span>. זה, במקרה ממוזל, גם הפתרון הנכון של המשוואה - קיבלנו רק מספרים שלמים חיוביים.</p>

<p>באופן כללי הפתרונות הם מספרים רציונליים, ולכן כדי למצוא פתרון שכולל רק שלמים יש את שורות 4-7, שבהן אני עובר על כל הערכים האפשריים של z (זוכרים שאני יכול להגביל אותם להיות בין 0 ל-10? פקודת ה-range שם יוצרת את הטווח הזה) ולכל אחד מהם מחשב את הערכים של x,y עבור הערך הזה של z, באמצעות פקודת subs (שאומרת “בביטוי הסימבולי הנוכחי שכולל את z, הצב כך-וכך במקום z ונראה מה תקבל”). לבסוף אני בודק שקיבלתי מספרים שלמים, על ידי כך שאני לוקח את המשתנים ומסתכל על הערך של המכנה (q) שלהם.</p>

<p>זה בוודאי נראה קצת מסורבל ביחס לפתרון הקודם שלי, אבל שימו לב שעכשיו יש לי רק לולאה אחת - על הערכים האפשריים של z. זה היה שיפור משמעותי בזמן הריצה, אם הבעיה הזו הייתה מסדרי גודל שבהם זה היה בכלל חשוב (וכמובן, גם שלב ה-solve דורש זמן לא טריוויאלי, אבל לרוב הוא יהיה יחסית מהיר).</p>

<p>האם אפשר היה לוותר על הלולאה הזו? כלומר, האם יש דרך חכמה מבחינה מתמטית למצוא z שמבטיח שנקבל מספרים שלמים? התשובה היא כן, והיא מתבססת על פתרון של <a href="http://www.gadial.net/2013/05/13/modular_arithmetic/">משוואות מודולריות</a>, אבל נעזוב את זה להפעם כי זה ייקח אותי רחוק מדי והפוסט כבר כך ארוך.</p>

<p>בואו נעבור לראות פתרון כללי עוד יותר, שעשוי להיראות כאן מסורבל שלא לצורך ולא יעיל במיוחד, אבל הוא המעניין ביותר מבחינה מתמטית, לדעתי. המטרה שלי היא לקבל את הפתרון הכללי למערכת המשוואות הדיופנטית הלינארית - כלומר, לקבל ביטוי סימבולי כלשהו שיש בו משתנים, ולכל ערך שלם שאני מציב במשתנים הללו אני מקבל פתרון של המערכת, וכל הפתרונות של המערכת מתקבלים כך. הדרך שבה אשתמש כדי למצוא אותו היא באמצעות מה שמכונה <strong>צורת סמית</strong> של מטריצה. מה שאומר שההמשך יהיה ברור רק למי שמכיר מטריצות, ועם הסליחה ממי שעדיין לא מכיר.</p>

<p>סטודנטים למתמטיקה ייתקלו בצורת סמית בהקשר של משפט המבנה של מודולים נוצרים סופית מעל תחום ראשי (או בהקשר של מקרה פרטי שלו - משפט המבנה של חבורות אבליות נוצרות סופית). זה משפט נפלא ונהדר, שממנו נובע לא רק המשפט הפשוט יותר עבור חבורות אלא גם צורת ז’ורדן והצורה הרציונלית של מטריצות. אבל זו מתמטיקה לא טריוויאלית שאין לי כוונה להיכנס אליה בפוסט, ולכן אסתפק בניסוח הכי יבש שרק אפשר. הרעיון הוא זה: נניח ש-<span>$latex A$</span> היא מטריצה, לאו דווקא ריבועית אלא מסדר <span>$latex n\times m$</span>. אז <strong>תמיד</strong> אפשר למצוא שתי מטריצות <strong>הפיכות</strong>, <span>$latex L,R$</span> (מלשון Left ו-Right) מסדרים <span>$latex n\times n$</span> ו-<span>$latex m\times m$</span>, כך ש-<span>$latex D=LAR$</span> היא מטריצה “אלכסונית בערך”. מה זה אומר? זו עדיין מטריצה מסדר <span>$latex n\times m$</span> ולכן אולי לא ריבועית בכלל, אבל הכניסות היחידות שלה שעשויות להיות שונות מאפס הן הכניסות <span>$latex D_{11},D_{22},\dots$</span>, והכניסות הללו גם מחלקות כל אחת את הבאה אחריה. והמשפט הזה נכון מעל שדות, כמו הרציונליים למשל, אבל גם מעל <strong>תחומים ראשיים</strong> כלליים - ולמי שלא מכיר, לא חשוב; מה שחשוב הוא רק שהשלמים הם תחום ראשי ולכן המשפט תקף לגביו. <span>$latex D$</span> הזו נקראת “צורת סמית” של <span>$latex A$</span>.</p>

<p>איך זה עוזר לנו לפתור משוואות? פשוט מאוד. נניח שאנחנו רוצים לפתור את מערכת המשוואות שמוגדרת על ידי <span>$latex Ax=b$</span>. אז זה תרגיל קל מאוד באלגברה לינארית להוכיח שאם נגדיר <span>$latex c=Lb$</span> ונמצא פתרון למערכת המשוואות <span>$latex Dy=c$</span>, אז פתרון למערכת המקורית נתון על ידי <span>$latex x=Ry$</span>. נסו להוכיח! כעת, מכיוון ש-D כל כך פשוטה, אפשר בלי קושי למצוא את הפתרון עבורה, ואז לחזור ולקבל פתרון למערכת המקורית. עכשיו, אם יש לנו מערכת שיש לה יותר מפתרון אחד, אפשר למצוא <strong>פתרון כללי</strong> למערכת ש-D מגדירה, ולקבל ממנו בחזרה פתרון כללי למערכת ש-A מגדירה.</p>

<p>רק בעיה “קטנה” נותרה - איך מוצאים את צורת סמית של מטריצה? ובכן, אם היינו פוסט אלגוריתמי, הייתי אומר שזה מסובך ולא טריוויאלי (אבל גם לא אסון). אבל אנחנו לא - אנחנו פוסט על “איך פותרים תרגילים בעזרת מחשב” ואני בכוונה רוצה להציג כלים חזקים, אז בואו נדבר על הכלי שאני בדרך כלל משתמש בו לחישובים מתמטיים - <a href="http://www.sagemath.org/">Sage</a>. אם SymPy שהזכרתי קודם היא ספריה קטנה ונחמדה, Sage היא לוויתן כחול אדיר. היא ערב-רב של ספריות מתמטיות מסוגים שונים ומשונים שחברו להם יחדיו, ומוחבאים כולם מאחורי ממשק משותף ונוח ביותר, שהוא בבסיסו פייתון עם טיפ-טיפה שיפורים. זה אומר שמדובר על הורדה יחסית כבדה (כמעט ג’יגה) ושקשה לשלב את Sage בתוך תוכנות קלילות שאתם רוצים לכתוב, אבל לשימוש שנועד לעמוד בפני עצמו, או סתם לשימוש בהתמודדות עם בעיה מורכבת, אני נוהג להשתמש ב-Sage.</p>

<p>יש בעולם הגדול עוד כלים דומים, כמובן; כמה שמות מיידיים הם מתמטיקה, מייפל ומטלאב. היתרון המיידי של Sage עליהם הוא שהיא חופשית לשימוש (ואם השמטתי אזכור לכלי חופשי לשימוש נוסף - למשל Maxima - קרוב לודאי שזה כי Sage משתמשת בו).</p>

<p>טוב, אז איך נראה פתרון ב-Sage לבעיה הזו? הוא יהיה מורכב משני חלקים, שאני מפריד ביניהם ברווח. בחלק הראשון מוצאים פתרון כללי למערכת, ובחלק השני שוב עושים חיפוש כוח גס מטופש אחרי הפתרון שאנחנו רוצים, סתם כי לא היה לי כוח לכתוב משהו אלגנטי יותר:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s">'t'</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">]])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="o">*</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>

<span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">true</span><span class="p">:</span>
  <span class="p">((</span><span class="n">a</span><span class="p">,),(</span><span class="n">b</span><span class="p">,),(</span><span class="n">c</span><span class="p">,))</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">val</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">a</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">print</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">x</span> <span class="o">=</span> <span class="o">%</span><span class="n">d</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="o">%</span><span class="n">d</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
    <span class="k">break</span>
  <span class="n">val</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
  <span class="k">if</span> <span class="n">val</span> <span class="o">&amp;</span><span class="n">gt</span><span class="p">;</span><span class="o">=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">val</span> <span class="o">+=</span> <span class="mi">1</span>
    </code></pre></figure>

</div>

<p>החלק הראשון הוא המעניין כאן. אם נסתכל על x בסופו, זה מה שנראה:</p>

<div class="code-block">

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="p">[</span> <span class="mi">40</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">3500</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mi">49</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">4400</span><span class="p">]</span>
<span class="p">[</span>   <span class="mi">9</span><span class="o">*</span><span class="n">t</span> <span class="o">-</span> <span class="mi">800</span><span class="p">]</span></code></pre></figure>

</div>

<p>וזה בעצם הפתרון הכללי למערכת. מה עשיתי כדי למצוא אותו? פשוט מאוד. בשורה 1 הגדרתי את המשתנה שבו אשתמש בתור פרמטר, כמו שהגדרתי בצורה דומה משתנים ב-SymPy. בשורה השניה והשלישית הגדרתי את מערכת המשוואות שלי בעזרת מטריצות (גם וקטור עמודה הוא מטריצה). ה-ZZ שמופיע שם אומר שמדובר על מטריצות מעל השלמים. בשורה 4 מצאתי את צורת סמית (הפונקציה מחזירה גם את D וגם את L,R, כמובן). רק בשורה 5 יש סוג של קסם. מה שקורה פה הוא שקודם כל אני פותר את המשוואה <span>$latex Dy=Lb$</span> שתיארתי קודם; עכשיו, בגלל הצורה של D, הפתרון של המשוואה הזו יהיה וקטור שהכניסה האחרונה בו היא 0, אבל בעצם גם כל ערך אחר בכניסה הזו היה עובד (למה? זו אולי השאלה הכי מאתגרת אליכם בפוסט; חשבו על ההגדרה של צורת סמית שנתתי קודם). לכן אני דוחף לשם את t, ואז כופל את הכל ב-R כדי לקבל את הפתרון הכללי למערכת המקורית.</p>

<p>מכאן רק נותר לי לחפש ערך של <span>$latex t$</span> שנותן ערכים חיוביים הן ל-x, הן ל-y והן ל-z, אבל שימו לב שכל ערך שלם שאציב ב-t יתן לי פתרון שלם של המשוואה - בעצם מצאתי את כל הפתרונות השלמים, והשיטה הזו תעבוד גם באופן כללי. אני משאיר לכם לחשוב איך אפשר למצוא יותר ביעילות ערך של <span>$latex t$</span> שיתן ערך חיובי לשלושת המשתנים - זה לא קשה וממש לא חייבים לערוך חיפוש ממצה אחריו כמו שאני עשיתי.</p>

<p>אם כן, הפוסט הזה היה קצת חריג - הרשיתי לעצמי להציג את פייתון ו-Sage, פשוט כי הם הכלים הראשונים שהייתי משתמש בהם כדי לפתור את הבעיה הזו; כלומר, אם לא היה אפשר לכתוב פתרון כוח גס ברובי שיעבוד. כלל האצבע שלי פשוט - אני תמיד כותב קודם כל פתרון כוח גס ברובי, ורק אם הוא נכשל בצורה מביכה (קורה הרבה, אבל לא הרבה כפי שאפשר היה לצפות) אני מאפטמז.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2014/04/02/student_and_computer_25/';
      this.page.identifier = 'http://gadial.net/2014/04/02/student_and_computer_25/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2014/04/02/student_and_computer_25/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username"></span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script></body>

</html>

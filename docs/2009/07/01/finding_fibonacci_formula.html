<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>איך מוצאים את נוסחת פיבונאצ’י? | לא מדויק</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="איך מוצאים את נוסחת פיבונאצ’י?" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="בדומה לפוסטים אחרים, גם המוטיבציה לפוסט הזה היא שאילתת חיפוש שראויה לתשובה רצינית ולא בת שתי שורות - במקרה הזה, “איך מוכיחים נוסחת פיבונאצ’י”. איני בטוח אם הכוונה היא רק להוכחה שהנוסחה נכונה, או גם למציאת הנוסחה; לדעתי מציאת הנוסחה היא העיקר ואז ההוכחה (באינדוקציה, או באמצעות כלים כבדים מאלגברה לינארית שמטפלים במקרה כללי בהרבה) היא די אלמנטרית, ולכן אתמקד בשאלת מציאת הנוסחה. התשובה טמונה בשיטה סטנדרטית לפתרון נוסחאות נסיגה, שזכורה לי בתור אחד מהדברים היפים ביותר שבהם נתקלתי כשרק התחלתי ללמוד מתמטיקה. ההתלהבות שלי מכך שאפשר למצוא את הנוסחה בפחות או יותר שלוש שורות של חשבון ברמת בית ספר תיכון נבעה מכך שהייתה זו פחות או יותר הפעם הראשונה שבה ראיתי איך ניתוח מתמטי רציני של בעיה שגם אני תהיתי לגביה “מחסל” אותה בקלי קלות - ההמחשה הטובה ביותר לטענת “מתמטיקאים הם עצלנים” של פוליה." />
<meta property="og:description" content="בדומה לפוסטים אחרים, גם המוטיבציה לפוסט הזה היא שאילתת חיפוש שראויה לתשובה רצינית ולא בת שתי שורות - במקרה הזה, “איך מוכיחים נוסחת פיבונאצ’י”. איני בטוח אם הכוונה היא רק להוכחה שהנוסחה נכונה, או גם למציאת הנוסחה; לדעתי מציאת הנוסחה היא העיקר ואז ההוכחה (באינדוקציה, או באמצעות כלים כבדים מאלגברה לינארית שמטפלים במקרה כללי בהרבה) היא די אלמנטרית, ולכן אתמקד בשאלת מציאת הנוסחה. התשובה טמונה בשיטה סטנדרטית לפתרון נוסחאות נסיגה, שזכורה לי בתור אחד מהדברים היפים ביותר שבהם נתקלתי כשרק התחלתי ללמוד מתמטיקה. ההתלהבות שלי מכך שאפשר למצוא את הנוסחה בפחות או יותר שלוש שורות של חשבון ברמת בית ספר תיכון נבעה מכך שהייתה זו פחות או יותר הפעם הראשונה שבה ראיתי איך ניתוח מתמטי רציני של בעיה שגם אני תהיתי לגביה “מחסל” אותה בקלי קלות - ההמחשה הטובה ביותר לטענת “מתמטיקאים הם עצלנים” של פוליה." />
<link rel="canonical" href="http://localhost:4000/blog/2009/07/01/finding_fibonacci_formula" />
<meta property="og:url" content="http://localhost:4000/blog/2009/07/01/finding_fibonacci_formula" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2009-07-01T18:06:15+03:00" />
<script type="application/ld+json">
{"headline":"איך מוצאים את נוסחת פיבונאצ’י?","dateModified":"2009-07-01T18:06:15+03:00","datePublished":"2009-07-01T18:06:15+03:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/2009/07/01/finding_fibonacci_formula"},"url":"http://localhost:4000/blog/2009/07/01/finding_fibonacci_formula","description":"בדומה לפוסטים אחרים, גם המוטיבציה לפוסט הזה היא שאילתת חיפוש שראויה לתשובה רצינית ולא בת שתי שורות - במקרה הזה, “איך מוכיחים נוסחת פיבונאצ’י”. איני בטוח אם הכוונה היא רק להוכחה שהנוסחה נכונה, או גם למציאת הנוסחה; לדעתי מציאת הנוסחה היא העיקר ואז ההוכחה (באינדוקציה, או באמצעות כלים כבדים מאלגברה לינארית שמטפלים במקרה כללי בהרבה) היא די אלמנטרית, ולכן אתמקד בשאלת מציאת הנוסחה. התשובה טמונה בשיטה סטנדרטית לפתרון נוסחאות נסיגה, שזכורה לי בתור אחד מהדברים היפים ביותר שבהם נתקלתי כשרק התחלתי ללמוד מתמטיקה. ההתלהבות שלי מכך שאפשר למצוא את הנוסחה בפחות או יותר שלוש שורות של חשבון ברמת בית ספר תיכון נבעה מכך שהייתה זו פחות או יותר הפעם הראשונה שבה ראיתי איך ניתוח מתמטי רציני של בעיה שגם אני תהיתי לגביה “מחסל” אותה בקלי קלות - ההמחשה הטובה ביותר לטענת “מתמטיקאים הם עצלנים” של פוליה.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/blog/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/blog/assets/css/main.css">
  <link rel="shortcut icon" href="/blog/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/blog/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/blog/feed.xml" title="לא מדויק" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$latex','$'] ],
        processEscapes: true
      },
       TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]}
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/blog/main">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/blog/main">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="dropdown1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">נושאים</a>
            <div class="dropdown-menu" aria-labelledby="dropdown1">
            
            <a class="dropdown-item text-right" href="/blog/analysis">אנליזה</a>
            
            <a class="dropdown-item text-right" href="/blog/algebra">אלגברה</a>
            
           </div>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/blog/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/blog/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="post_list.html" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">איך מוצאים את נוסחת פיבונאצ&#39;י?</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2009-07-01T18:06:15+03:00" itemprop="datePublished">Jul 1, 2009
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>בדומה לפוסטים אחרים, גם המוטיבציה לפוסט הזה היא שאילתת חיפוש שראויה לתשובה רצינית ולא בת שתי שורות - במקרה הזה, “איך מוכיחים נוסחת פיבונאצ’י”. איני בטוח אם הכוונה היא רק להוכחה שהנוסחה נכונה, או גם <strong>למציאת</strong> הנוסחה; לדעתי מציאת הנוסחה היא העיקר ואז ההוכחה (באינדוקציה, או באמצעות כלים כבדים מאלגברה לינארית שמטפלים במקרה כללי בהרבה) היא די אלמנטרית, ולכן אתמקד בשאלת מציאת הנוסחה. התשובה טמונה בשיטה סטנדרטית לפתרון נוסחאות נסיגה, שזכורה לי בתור אחד מהדברים היפים ביותר שבהם נתקלתי כשרק התחלתי ללמוד מתמטיקה. ההתלהבות שלי מכך שאפשר למצוא את הנוסחה בפחות או יותר שלוש שורות של חשבון ברמת בית ספר תיכון נבעה מכך שהייתה זו פחות או יותר הפעם הראשונה שבה ראיתי איך ניתוח מתמטי רציני של בעיה שגם אני תהיתי לגביה “מחסל” אותה בקלי קלות - ההמחשה הטובה ביותר לטענת “מתמטיקאים הם עצלנים” של <a href="http://www.gap-system.org/~history/Quotations/Polya.html">פוליה</a>.</p>

<p>אבל ראשית יש להציג את הבעיה. תחילתה באחד מהמתמטיקאים האירופאים הבולטים הבודדים של ימי הביניים, שהיו תקופה חשוכה במיוחד עבור המתמטיקה, בין הפריחה האדירה לה היא זכתה ביוון העתיקה, והפריחה האדירה שלה החל מימי הרנסנס והלאה. בימי הביניים עיקר המתמטיקה השתמר ופותח בידי המוסלמים, וגם ליאונרדו מפיזה המוכר יותר בשם <a href="http://he.wikipedia.org/wiki/%D7%A4%D7%99%D7%91%D7%95%D7%A0%D7%A6%27%D7%99">פיבונאצ'י</a>, איטלקי, למד מתמטיקה אצל מורים מוסלמים כשגדל באלג’יר. בשנת 1202 פרסם פיבונאצ’י ספר - “ספר החשבוניה” - שהקיף את הידע המתמטי על אלגברה של אותה תקופה (בתקופת היוונים עסקו בעיקר בגאומטריה, וגם בעיות מספריות, דוגמת מציאת <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%97%D7%9C%D7%A7_%D7%9E%D7%A9%D7%95%D7%AA%D7%A3_%D7%9E%D7%A7%D7%A1%D7%99%D7%9E%D7%9C%D7%99">מחלק משותף מקסימלי</a> - “האלגוריתם האוקלידי” - נוסחו באופן גאומטרי; בשלהי תקופת יוון העתיקה ובתקופת המוסלמים עיקר הדגש עבר לאלגברה, והמילה “אלגברה” עצמה הגיעה משם ספר של המתמטיקאי המוסלמי המפורסם ביותר, <a href="http://he.wikipedia.org/wiki/%D7%90%D7%91%D7%95_%D7%92%27%D7%A2%D7%A4%D7%A8_%D7%9E%D7%95%D7%97%D7%9E%D7%93_%D7%90%D7%9C-%D7%97%27%D7%95%D7%90%D7%A8%D7%99%D7%96%D7%9E%D7%99">אל-ח'ואריזמי</a>). הספר הכיל כמה מהחידושים המסעירים בתחום - למשל, השיטה העשרונית ושימוש באפס. הוא גם הכיל חידה חביבה שעסקה בארנבים.</p>

<p>אציג כאן את אחד מהניסוחים של הבעיה - איני מתחייב לניסוח המקורי של פיבונאצ’י, שכן אני מעדיף את הניסוח שנראה לי הכי פשוט להבנה. נניח שאוכלוסיית ארנבים מתרבה באופן המשונה הבא: זוג בוגר של ארנבים מביא לעולם, תוך חודש, זוג צעיר של ארנבים, וכך בכל חודש. לזוג צעיר של ארנבים לוקח חודש לגדול ולהפוך לזוג בוגר בעצמו, ואז גם הוא מתחיל להוליד. הארנבים כולם בני אלמוות. כעת, נניח שאנחנו מתחילים עם זוג של ארנבים צעירים - כמה זוגות (שימו לב - זוגות, לא ארנבים בודדים; הזוגות הם תמיד של זכר ונקבה, באופן קסום) של ארנבים <strong>בוגרים</strong> יהיו לנו בחודש ה-<span>$latex n$</span>-י?</p>

<p>ובכן, בחודש הראשון יש 0 זוגות של ארנבים בוגרים - יש זוג אחד של ארנבים צעירים ותו לא. בחודש שלאחר מכן יש זוג אחד של ארנבים בוגרים (הזוג הצעיר שלנו התבגר), ואפס זוגות של ארנבים צעירים. בחודש לאחר מכן יש את אותו הזוג של ארנבים בוגרים, וזוג חדש של ארנבים צעירים שהם הולידו; ובחודש שלאחר מכן הארנבים שהיו צעירים התבגרו, כך שיש לנו שני זוגות של ארנבים בוגרים, ובנוסף יש זוג צעיר אחד חדש. אם תמשיכו את המשחק הזה עוד ועוד, בוודאי תקבלו את סדרת הערכים הבאה, עבור מספר הארנבים הבוגרים בכל חודש: <span>$latex 0,1,1,2,3,5,8,13,\dots$</span>. מה שפיבונאצ’י רצה לעשות הוא למצוא חוקיות בסדרה הזו.</p>

<p>נסמן את אברי הסדרה בתור <span>$latex F_{n}$</span>, כאשר <span>$latex n$</span> הוא מספר החודש המתאים. לצורך נוחות, החודש הראשון יסומן ב-0, ולכן הסדרה היא <span>$latex F_{0}=0,F_{1}=1,F_{2}=1,F_{3}=2$</span> וכן הלאה. החוקיות שפיבונאצ’י הצביע עליה היא פשוטה במיוחד: <span>$latex F_{n}=F_{n-1}+F_{n-2}$</span>. כלומר, כל איבר בסדרה (לאחר שני האיברים הראשונים) שווה לסכום שני האיברים שקדמו לו. מעט מחשבה מראה מדוע זה כך במקרה של הארנבונים. מהו <span>$latex F_{n}$</span>, בעצם? הוא מספר זוגות הארנבונים שהיו בוגרים בחודש שלפני כן, ועוד מספר זוגות הארנבונים שהיו <strong>צעירים</strong> בחודש שלפני כן, והתבגרו. מספר זוגות הארנבונים שהיו בוגרים בחודש שלפני כן הוא בדיוק <span>$latex F_{n-1}$</span> - זה מה שמספר זה סופר. אבל כמה זוגות ארנבונים צעירים היו? ובכן, הכלל הוא שארנבון צעיר בחודש מסויים הוא ה”תוצר” הישיר של זוג ארנבונים שהיו <strong>מבוגרים</strong> בחודש שלפני כן. כלומר, אם אנחנו רוצים לספור כמה ארנבונים צעירים היו בחודש <span>$latex n-1$</span>, התשובה היא שמספר זה שווה למספר הארנבונים המבוגרים בחודש <span>$latex n-2$</span>. כלומר, <span>$latex F_{n-2}$</span> הוא בדיוק מספר הארנבונים שהיו צעירים בחודש <span>$latex n-1$</span>, ומכאן נובעת הנוסחה. הנוסחה הזו, שבה איבר בסדרה מתואר באמצעות איברים מוקדמים יותר בסדרה, נקראת <strong>נוסחה רקורסיבית</strong> (רקורסיה היא הגדרה של דבר מה באמצעות הסתמכות על מופעים יותר פשוטים שלו - במקרה שלנו, איבר בסדרה מוגדר באמצעות איברים קטנים יותר בסדרה, עד לאיברים <span>$latex F_{0},F_{1}$</span> שמוגדרים בצורה ישירה) או בעברית, <strong>נוסחת נסיגה</strong>.</p>

<p><a href="http://he.wikipedia.org/wiki/%D7%A1%D7%93%D7%A8%D7%AA_%D7%A4%D7%99%D7%91%D7%95%D7%A0%D7%90%D7%A6%27%D7%99">סדרת פיבונאצ'י</a>הייתה מוכרת זמן רב לפני פיבונאצ’י וחידת הארנבים שלו, אך פיבונאצ’י זכה בכבוד שבקריאת הסדרה על שמו. קשה להתחיל ולתאר בכמה מקומות במתמטיקה מופיעה הסדרה - החל בניתוח הסיבוכיות של האלגוריתם האוקלידי, וכלה בהוכחה ש<a href="http://he.wikipedia.org/wiki/%D7%94%D7%91%D7%A2%D7%99%D7%94_%D7%94%D7%A2%D7%A9%D7%99%D7%A8%D7%99%D7%AA_%D7%A9%D7%9C_%D7%94%D7%99%D7%9C%D7%91%D7%A8%D7%98">הבעיה העשירית של הילברט</a> היא בלתי כריעה. מכיוון שהפוסט הזה אינו מיועד לתיאור סדרת פיבונאצ’י ואני רחוק מלהכיר אפילו מקצת משימושיה, לא אכנס לכך כעת. תחת זאת אתמקד בבעיה שעדיין נותרה פתוחה - מציאת נוסחה סגורה לאברי הסדרה.</p>

<p>מה הבעיה כרגע? נניח שאני רוצה מסיבה כלשהי לחשב את <span>$latex F_{137}$</span>. איך אני עושה זאת? אם כל מה שיש לי הוא הנוסחה הרקורסיבית, עלי לחשב את <span>$latex F_{136}$</span> ואת <span>$latex F_{135}$</span>, כלומר הצטצמתי לבעיה יותר פשוטה, ועדיין גם היא דורשת עבודה - כדי לחשב את <span>$latex F_{136}$</span> אני צריך את <span>$latex F_{135}$</span> (שאמנם, אני ממילא צריך) אבל גם את <span>$latex F_{134}$</span> וכן הלאה וכן הלאה - כלומר, כדי לחשב את <span>$latex F_{137}$</span> אצטרך לחשב את כל <span>$latex F_{n}$</span> עבור <span>$latex n&lt;137$</span>. חייבים להודות שזה לא נשמע יעיל במיוחד. האם אין דרך לחשב את <span>$latex F_{n}$</span> בלי לחשב את כל האיברים הקודמים בסדרה?</p>

<p>התשובה חיובית, וכדי להבהיל אתכם גם אתן אותה במפורש עכשיו - מתקיים ש-<span>$latex F_{n}=\frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^{n}-\left(\frac{1-\sqrt{5}}{2}\right)^{n}\right]$</span>. הנוסחה הזו נראית מבעיתה לגמרי - משום מקום צץ לו שורש 5, שהוא בכלל לא מספר רציונלי, ומעלים דברים בחזקת <span>$latex n$</span> ולך תחשב את זה בכלל והצילו. ובכן, אתם מוזמנים לבדוק עבור ערכים קטנים של <span>$latex n$</span> שהנוסחה עובדת, וכל השורשים של חמש מצטמצמים והכל טוב ויפה; ומחשב מסוגל להשתמש בנוסחה הזו כדי לחשב את <span>$latex F_{n}$</span> בקלות רבה יחסית, הרבה יותר מאשר שימוש בנוסחה הרקורסיבית וחישוב כל הערכים הקודמים בסדרה (למעשה, לא חייבים לחשב את הנוסחה שמוצגת בנוסחה כמות שהיא ואפשר לבצע כל מני שיפורים אך לא אכנס לכך).</p>

<p>אם כן, איך מגיעים לנוסחה הזו? מה ההגיון שבה? מאיפה צץ השורש? והאם הפתרון הוא אד-הוקי ומתאים רק לפיבונאצ’י? אענה על הכל, ואתחיל מהשאלה האחרונה - לגמרי לא. השיטה שאציג עובדת לכל נוסחה רקורסיבית שהיא לינארית במקדמים קבועים והומוגנית - ובמילים המפוצצות הללו אני מתכוון לכך שנוסחת הנסיגה היא באופן כללי מהצורה <span>$latex a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\dots+c_{k}a_{n-k}$</span>, כלומר שהאיבר ה-<span>$latex n$</span> בסדרה הוא סכום של <span>$latex k$</span> האיברים הקודמים בסדרה, כשהם מוכפלים במספרים קבועים <span>$latex c_{1},\dots,c_{k}$</span>. למשל, <span>$latex a_{n}=3a_{n-1}+5a_{n-4}$</span> היא דוגמה נוספת לסדרה שמתאימה לנוסחה הזו. השיטה שאציג תקפה לכל המשוואות הללו, אך אציג אותה עבור הדוגמה הספציפית של פיבונאצ’י כדי לא להסתבך יותר מדי עם הסימונים.</p>

<p>לאלו מכם שמכירים <a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A9%D7%95%D7%95%D7%90%D7%94_%D7%93%D7%99%D7%A4%D7%A8%D7%A0%D7%A6%D7%99%D7%90%D7%9C%D7%99%D7%AA">משוואות דיפרנציאליות</a>, המילים “משוואה לינארית במקדמים קבועים והומוגנית” עשויה להיות מוכרת מאוד - בעיות דומות יש גם במשוואות דיפרנציאליות. גם “תנאי ההתחלה” של הנוסחה הרקורסיבית (במקרה של פיבונאצ’י, <span>$latex F_{0}=0,F_{1}=1$</span>; במקרה של סדרה שבה איבר תלוי ב-<span>$latex k$</span> הקודמים, תנאי ההתחלה צריך להיות <span>$latex k$</span> האיברים הראשונים בסדרה) מזכירים את המושג המקביל ממשוואות דיפרנציאליות, וגם שיטת הפתרון היא דומה - מתחילים מ”ניחוש מוצלח” של איך בערך הפתרון <strong>אמור להיראות</strong>, מציבים אותו במשוואה, ומקבלים מההצבה הזו את הפתרון המדוייק. זה לא מוכיח מיידית שהפתרון נכון, אלא צריך להוכיח זאת - אלא שההוכחה אינה קשה ומספיק לבצע אותה פעם אחת, עבור נוסחת הנסיגה ה”כללית” (הלינארית-מקדמים קבועים-הומוגנית), ואז מספיק יהיה להשתמש בשיטה כדי <strong>למצוא</strong> את הפתרון (שהוא הדבר שמעניין אותנו, בסופו של דבר).</p>

<p>כבר אגלה מראש שהניחוש הבסיסי שלנו הוא שפתרון נוסחת נסיגה “כללית” הוא מהצורה <span>$latex a_{n}=\lambda^{n}$</span> עבור מספר ממשי כלשהו <span>$latex \lambda$</span>. כלומר, שהאיבר ה-<span>$latex n$</span>-י בסדרה הוא העלאה בחזקה <span>$latex n$</span>-ית של מספר קבוע כלשהו, שתלוי רק בנוסחת הנסיגה הספציפית ולא ב-<span>$latex n$</span>. בוודאי תצעקו כעת שהפתרון של פיבונאצ’י אינו בדיוק כזה - אני יודע, ונגיע לכך. לפני כן צריך להבין איך בכלל הגענו לניחוש הזה - למה שזה יהיה משהו בחזקת <span>$latex n$</span>? למה לא <span>$latex n^{t}$</span>, למשל? (שימו לב להבדל - כעת <span>$latex n$</span> הוא בסיס החזקה ולא המעריך שלה, כמקודם). התשובה לכך היא שניתן להעריך את קצב הגידול של הפונקציה לא רע. אדגים זאת על פיבונאצ’י. מכיוון ש-<span>$latex F_{n}=F_{n-1}+F_{n-2}$</span> וכל האיברים (פרט ל-<span>$latex F_{0}$</span>) הם חיוביים, אז <span>$latex F_{n}&gt;F_{n-1}$</span> לכל <span>$latex n&gt;1$</span>. מכאן בפרט שמתקיים <span>$latex F_{n}=F_{n-1}+F_{n-2}&lt;2F_{n-1}$</span>, כלומר <span>$latex F_{n}$</span> לא גדול יותר מאשר פי 2 האיבר שקדם לו, <span>$latex F_{n-1}$</span>, ולכן קצב הגידול שלו אינו גדול <strong>מדי</strong>: מתקיים ש-<span>$latex F_{n}&lt;2^{n}$</span> (כי אם האיבר <span>$latex F_{1}$</span> הוא 1, השני הוא לא יותר מאשר 2, והשלישי לא יותר מאשר 4, והרביעי לא יותר מאשר 8, וכן הלאה).</p>

<p>מצד שני, <span>$latex F_{n}=F_{n-1}+F_{n-2}&gt;2F_{n-2}$</span>. כלומר, <span>$latex F_{n}$</span> הוא <strong>לפחות</strong> גדול פי 2 מאשר <span>$latex F_{n-2}$</span>, ולכן קצב הגידול שלו אינו יכול להיות קטן <strong>מדי</strong>: מתקיים ש-<span>$latex F_{n}&gt;2^{\left\lfloor \frac{n}{2}\right\rfloor }$</span>. שוב, לדוגמה - אם <span>$latex F_{1}=1$</span> אז האיבר השלישי בסדרה הוא לפחות 2, והאיבר החמישי הוא לפחות 4, והשביעי הוא לפחות 8 וכן הלאה. כלומר, קיבלנו שקצב הגידול של <span>$latex F_{n}$</span> הוא אקספוננציאלי - הוא חסום הן מלמעלה והן מלמטה על ידי חזקה <span>$latex n$</span>-ית של מספר כלשהו (שימו לב ש-<span>$latex 2^{\frac{n}{2}}=\left(\sqrt{2}\right)^{n}$</span> ומכאן שזה ש-<span>$latex n$</span> מופיע במעריך כשהוא מוכפל במשהו לא באמת משנה עבורו, אלא רק עבור הבסיס של החזקה). מכאן שבדיקת מועמד לפתרון שהוא מהצורה <span>$latex \lambda^{n}$</span> היא מתבקשת; הוא מסדר הגודל הנכון. מי שלא עלה בידו לעקוב אחרי כל האסימפטוטיקה הזו - לא נורא. מטרתה לתת מוטיבציה לפתרון ולהמחיש שלא מדובר בניחוש ממוזל בלבד אלא בבחירה מושכלת, אך אין זה הכרחי להמשך הפתרון.</p>

<p>כעת אנו מגיעים לשאלה המרכזית. נניח כי <span>$latex F_{n}=\lambda^{n}$</span> הוא אכן פתרון לנוסחת הנסיגה; מהו <span>$latex \lambda$</span>? לצורך כך ניתן להציב את הפתרון בנוסחה <span>$latex F_{n}=F_{n-1}+F_{n-2}$</span> ולקבל את המשוואה <span>$latex \lambda^{n}=\lambda^{n-1}+\lambda^{n-2}$</span>. ברור כי <span>$latex \lambda=0$</span> פותר את נוסחת הנסיגה (פתרון כזה פותר גם את הנוסחה ה”כללית” שלעיל) אבל זה אינו פתרון מעניין, אז נניח כי <span>$latex \lambda\ne0$</span>, ולכן אפשר לחלק את המשוואה שקיבלנו ב-<span>$latex \lambda^{n-2}$</span> ולקבל <span>$latex \lambda^{2}=\lambda+1$</span>, או, אחרי העברת אגפים, <span>$latex \lambda^{2}-\lambda-1=0$</span>. זוהי משוואה ריבועית פשוטה ואנו יודעים לפתור אותה בעזרת הנוסחה הכללית. נקבל <span>$latex \lambda=\frac{1\pm\sqrt{1+4}}{2}=\frac{1\pm\sqrt{5}}{2}$</span>. כלומר, קיבלנו שני פתרונות, ובשניהם צץ לו ה-<span>$latex \sqrt{5}$</span> המבהיל. מכאן זה מגיע.</p>

<p>כדי לעשות לעצמי את החיים פשוטים יותר מעתה והלאה, אשתמש בסימון סטנדרטי: <span>$latex \phi_{+}=\frac{1+\sqrt{5}}{2}$</span>, ו-<span>$latex \phi_{-}=\frac{1-\sqrt{5}}{2}$</span>. המספר <span>$latex \phi_{+}$</span> הוא “יחס הזהב” המפורסם. אם כן, הגענו למסקנה ש-<span>$latex F_{n}=\phi_{+}^{n}$</span> ו-<span>$latex F_{n}=\phi_{-}^{n}$</span> הם פתרונות של נוסחת הנסיגה <span>$latex F_{n}=F_{n-1}+F_{n-2}$</span>. מדוע זה לא הפתרון שהצגתי לעיל ומה עוד לא עשינו?</p>

<p>הבעיה בשני הפתרונות שמצאנו היא שהם אינם עונים ל”תנאי ההתחלה”. צריך, למשל, שיתקיים <span>$latex F_{0}=0$</span>. מיידית ברור שהייתי אידיוט גמור אם חשבתי שפתרון מהצורה <span>$latex \lambda^{n}$</span> יקיים זאת - חזקה של מספר שאינו 0, אינה 0. כמו כן צריך שיתקיים <span>$latex F_{1}=1$</span>, ולכן הפתרון העלוב <span>$latex \lambda=0$</span> גם כן לא טוב לנו. בקיצור, האם צריך לזרוק לזבל את כל הרעיון שהפתרון הוא מהצורה <span>$latex \lambda^{n}$</span>? לא, צריך רק להרחיב מעט את אוסף הפתרונות שלנו - משני פתרונות, לאינסוף.</p>

<p>באופן כללי, אם <span>$latex f\left(n\right)$</span> הוא פתרון של נוסחת הנסיגה של פיבונאצ’י (ושוב, מה שאני אומר תקף גם לנוסחה ה”כללית”), כלומר אם <span>$latex f\left(n\right)=f\left(n-1\right)+f\left(n-2\right)$</span> אז גם <span>$latex h\left(n\right)=\alpha\cdot f\left(n\right)$</span>, כאשר <span>$latex \alpha$</span> הוא מספר ממשי, הוא פתרון, כי הרי <span>$latex h\left(n\right) = \alpha f\left(n\right)=\alpha\left(f\left(n-1\right)+f\left(n-2\right)\right)=\alpha f\left(n-1\right)+\alpha f\left(n-2\right) = h\left(n-1\right)+h\left(n-2\right)$</span> באופן דומה, אם <span>$latex f\left(n\right),g\left(n\right)$</span> שניהם פתרונות, אז גם <span>$latex h\left(n\right)=f\left(n\right)+g\left(n\right)$</span> הוא פתרון, כי</p>

<p><span>$latex h\left(n\right) = f\left(n\right)+g\left(n\right)=\left(f\left(n-1\right)+f\left(n-2\right)\right)+\left(g\left(n-1\right)+g\left(n-2\right)\right) = \left(f\left(n-1\right)+g\left(n-1\right)\right)+\left(f\left(n-2\right)+g\left(n-2\right)\right)=h\left(n-1\right)+h\left(n-2\right)$</span></p>

<p>אם כן, אוסף הפתרונות של המשוואה סגור לפעולות של “כפל בסקלר” (כפל במספר ממשי, במקרה שלנו) ושל חיבור שני פתרונות. אלו מכם שמכירים אלגברה לינארית ודאי רואים כעת כי אוסף הפתרונות של נוסחת הנסיגה (אם לא דורשים את קיום תנאי ההתחלה) מהווה <strong><a href="http://he.wikipedia.org/wiki/%D7%9E%D7%A8%D7%97%D7%91_%D7%95%D7%A7%D7%98%D7%95%D7%A8%D7%99">מרחב וקטורי</a></strong>. הבסיס של המרחב הזה הם בדיוק שני הפתרונות שמצאנו בהתחלה - <span>$latex \phi_{+}^{n},\phi_{-}^{n}$</span>. מי שאינו מכיר אלגברה לינארית עדיין יכול לראות, משתי התכונות שהדגמתי לעיל, שאם <span>$latex f\left(n\right),g\left(n\right)$</span> הם שני פתרונות לנוסחת הנסיגה, אז גם <span>$latex \alpha f\left(n\right)+\beta g\left(n\right)$</span> הוא פתרון, עבור כל <span>$latex \alpha,\beta$</span> ממשיים שנבחר. לכן הגדלנו בצורה משמעותית את אוסף הפתרונות האפשריים שלנו - אולי אחד מהם כן עונה לתנאי ההתחלה?</p>

<p>אם כן, נכתוב פתרון “כללי” לנוסחת הנסיגה בתור <span>$latex F_{n}=\alpha\phi_{+}^{n}+\beta\phi_{-}^{n}$</span>. אנו רוצים לגלות מהם <span>$latex \alpha,\beta$</span> שעבורם יתקיימו תנאי ההתחלה, אז נשתמש בכך שידוע ש-<span>$latex F_{0}=0$</span> ונקבל את הנוסחה <span>$latex 0=\alpha\phi_{+}^{0}+\beta\phi_{-}^{0}=\alpha+\beta$</span>, כלומר אנחנו כבר יודעים שבהכרח מתקיים <span>$latex \alpha=-\beta$</span>. לכן נכתוב את הפתרון בתור <span>$latex F_{n}=\alpha\left(\phi_{+}^{n}-\phi_{-}^{n}\right)$</span>. כעת נשתמש במשוואה הנוספת שנותרה לנו - <span>$latex F_{1}=1$</span>. נקבל ממנה כי <span>$latex 1=\alpha\left(\phi_{+}-\phi_{-}\right)$</span>, אבל את <span>$latex \phi_{+}-\phi_{-}$</span> קל לנו לחשב: <span>$latex \phi_{+}-\phi_{-}=\frac{1+\sqrt{5}}{2}-\frac{1-\sqrt{5}}{2}=\sqrt{5}$</span>. מכאן נקבל ש-<span>$latex 1=\alpha\sqrt{5}$</span>, ובמילים אחרות - <span>$latex \alpha=\frac{1}{\sqrt{5}}$</span>. לכן הפתרון הנכון לנוסחת פיבונאצ’י, זה שמתאים גם לתנאי ההתחלה, הוא <span>$latex F_{n}=\frac{1}{\sqrt{5}}\left(\phi_{+}^{n}-\phi_{-}^{n}\right)$</span> (וזו גם המפלצת שהצגתי לעיל, עם סימונים מעט יותר ידידותיים). ושוב, מה שעשיתי כאן, עם המרחב הלינארי והכל, זהה למה שעושים כאשר פותרים משוואות דיפרנציאליות לינאריות.</p>

<p>מה שעשיתי נראה אולי מעט אד-הוקי בשל הצורה שבה מצאתי את <span>$latex \alpha,\beta$</span>, אבל זה רק כי נמנעתי מלהשתמש בשיטת הפתרון הכללית למשוואות לינאריות, שהייתה נותנת את אותה התוצאה. באופן כללי, כשיש לנו משוואה מהצורה <span>$latex a_{n}=c_{1}a_{n-1}+c_{2}a_{n-2}+\dots+c_{k}a_{n-k}$</span>, הצבה של <span>$latex \lambda^{n}$</span> מניבה את המשוואה <span>$latex \lambda^{k}-c_{1}\lambda^{k-1}-\dots c_{k-1}\lambda-c_{k}=0$</span>. עבור <span>$latex k\ge5$</span> כבר אין נוסחה סגורה פשוטה עבור פתרונות המשוואה (ניתן להראות זאת באמצעות <a href="http://he.wikipedia.org/wiki/%D7%AA%D7%95%D7%A8%D7%AA_%D7%92%D7%9C%D7%95%D7%90%D7%94">תורת גלואה</a>, וזה עניין לסדרת פוסטים בפני עצמה), ויכולות להיות בעיות נוספות עם הפתרונות (הם יהיו מרוכבים, או שאותו פתרון יופיע מספר פעמים, בדומה לכך שהפתרון היחיד של <span>$latex x^{2}-2x+1$</span> הוא <span>$latex x=1$</span>) אבל למרות כל הבעיות הללו ניתן לבנות <span>$latex k$</span> פתרונות שונים למשוואה שיהוו בסיס למרחב הפתרונות שלה, וניתן להראות שלכל בחירה של תנאי ההתחלה נקבל פתרון יחיד. כל זה דורש אלגברה לינארית שלא אוכל להיכנס אליה כעת, אבל בעתיד אולי ארחיב על כך (בפוסט שיהיה בהכרח טכני יותר מזה הנוכחי). ושוב - גם במשוואות דיפרנציאליות כל הסיפור הזה מתרחש באופן זהה.</p>

<p>הפתרון שהצגתי אולי נראה ארוך למדי כי הכברתי הסברים, אך מבחינה מעשית הוא פשוט בצורה יוצאת דופן - פותרים משוואה ריבועית, ואז פותרים עוד מערכת של שתי משוואות בשני נעלמים. הכל חומר של תיכון, ודורש שלוש שורות חישוב - והנוסחה לפיבונאצ’י בהישג יד. קשה לי להסביר עד כמה מצער אותי שנמנעים מלהציג את הנוסחה הזו בתיכון - לשם מה בכלל לדעת איך פותרים משוואות, אם לא בשביל דברים כאלו?</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><a class="u-url" href="/blog/2009/07/01/finding_fibonacci_formula" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username"></span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="/blogassets/js/jquery-slim.min.js"><\/script>')</script><script src="/blog/assets/js/bootstrap.bundle.js"></script></body>

</html>

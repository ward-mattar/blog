<!DOCTYPE html>
<html lang="he" dir="rtl"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>סדרות לוקאס ומבחני ראשוניות | לא מדויק</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="סדרות לוקאס ומבחני ראשוניות" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="בפוסט הקודם התעסקתי בראשוניי מרסן והקשר הקרוב שלהם למספרים מושלמים. זה עשה לי חשק לדבר על עוד סיבה שבגללה ראשוניי מרסן הם מעניינים, אולי הסיבה הבולטת ביותר למי שלא מתעסקים במתמטיקה ונתקלים מדי פעם בכותרות בעיתונים: יש מבחן לבדיקת ראשוניות של מספרי מרסן שהוא יעיל בצורה יוצאת דופן ובזכותו הצלחנו לגלות מספרים ראשוניים שהם גדולים משמעותית ממה שכל שיטה אחרת מניבה לנו. בכל פעם בחמישים ומשהו השנים האחרונות שבה זעקו הכותרות על “התגלה הראשוני הגדול ביותר אי פעם!” זה היה ראשוני מרסן, שהתגלה באמצעות מבחן הראשוניות הזה, שנקרא מבחן לוקאס-להמר (כנראה שיש לכתוב “לוקה” כי כך מבטאים את השם, אבל “לוקאס” הוא הכתיב הפופולרי בעברית עבור המתמטיקאי הספציפי הזה). המבחן פשוט בצורה קיצונית, ולכן אציג אותו כמעט מייד; שארית הפוסט תעסוק בשאלה למה המבחן עובד, אבל תלך הרבה יותר רחוק מכך, אל תוצאות ורעיונות כלליים ומגניבים עוד יותר. המחיר יהיה פוסט טכני מאוד, כפי שלרוב קורה כשמתחילים לנבור בתוצאות כמו זו, אבל כל מי שיש לו ידע בסיסי כלשהו באלגברה מופשטת או תורת המספרים כנראה יוכל להבין את הרוב (אני אצטט פה ושם תוצאות בלי להוכיח, אבל גם הן לא משהו עמוק במיוחד)." />
<meta property="og:description" content="בפוסט הקודם התעסקתי בראשוניי מרסן והקשר הקרוב שלהם למספרים מושלמים. זה עשה לי חשק לדבר על עוד סיבה שבגללה ראשוניי מרסן הם מעניינים, אולי הסיבה הבולטת ביותר למי שלא מתעסקים במתמטיקה ונתקלים מדי פעם בכותרות בעיתונים: יש מבחן לבדיקת ראשוניות של מספרי מרסן שהוא יעיל בצורה יוצאת דופן ובזכותו הצלחנו לגלות מספרים ראשוניים שהם גדולים משמעותית ממה שכל שיטה אחרת מניבה לנו. בכל פעם בחמישים ומשהו השנים האחרונות שבה זעקו הכותרות על “התגלה הראשוני הגדול ביותר אי פעם!” זה היה ראשוני מרסן, שהתגלה באמצעות מבחן הראשוניות הזה, שנקרא מבחן לוקאס-להמר (כנראה שיש לכתוב “לוקה” כי כך מבטאים את השם, אבל “לוקאס” הוא הכתיב הפופולרי בעברית עבור המתמטיקאי הספציפי הזה). המבחן פשוט בצורה קיצונית, ולכן אציג אותו כמעט מייד; שארית הפוסט תעסוק בשאלה למה המבחן עובד, אבל תלך הרבה יותר רחוק מכך, אל תוצאות ורעיונות כלליים ומגניבים עוד יותר. המחיר יהיה פוסט טכני מאוד, כפי שלרוב קורה כשמתחילים לנבור בתוצאות כמו זו, אבל כל מי שיש לו ידע בסיסי כלשהו באלגברה מופשטת או תורת המספרים כנראה יוכל להבין את הרוב (אני אצטט פה ושם תוצאות בלי להוכיח, אבל גם הן לא משהו עמוק במיוחד)." />
<link rel="canonical" href="http://gadial.net/2016/11/22/lucas_sequences/" />
<meta property="og:url" content="http://gadial.net/2016/11/22/lucas_sequences/" />
<meta property="og:site_name" content="לא מדויק" />
<meta property="og:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-11-22T14:43:35+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://gadial.net/assets/img/main/default-card.png" />
<meta property="twitter:title" content="סדרות לוקאס ומבחני ראשוניות" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"dateModified":"2016-11-22T14:43:35+00:00","datePublished":"2016-11-22T14:43:35+00:00","@type":"BlogPosting","image":"http://gadial.net/assets/img/main/default-card.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://gadial.net/2016/11/22/lucas_sequences/"},"url":"http://gadial.net/2016/11/22/lucas_sequences/","description":"בפוסט הקודם התעסקתי בראשוניי מרסן והקשר הקרוב שלהם למספרים מושלמים. זה עשה לי חשק לדבר על עוד סיבה שבגללה ראשוניי מרסן הם מעניינים, אולי הסיבה הבולטת ביותר למי שלא מתעסקים במתמטיקה ונתקלים מדי פעם בכותרות בעיתונים: יש מבחן לבדיקת ראשוניות של מספרי מרסן שהוא יעיל בצורה יוצאת דופן ובזכותו הצלחנו לגלות מספרים ראשוניים שהם גדולים משמעותית ממה שכל שיטה אחרת מניבה לנו. בכל פעם בחמישים ומשהו השנים האחרונות שבה זעקו הכותרות על “התגלה הראשוני הגדול ביותר אי פעם!” זה היה ראשוני מרסן, שהתגלה באמצעות מבחן הראשוניות הזה, שנקרא מבחן לוקאס-להמר (כנראה שיש לכתוב “לוקה” כי כך מבטאים את השם, אבל “לוקאס” הוא הכתיב הפופולרי בעברית עבור המתמטיקאי הספציפי הזה). המבחן פשוט בצורה קיצונית, ולכן אציג אותו כמעט מייד; שארית הפוסט תעסוק בשאלה למה המבחן עובד, אבל תלך הרבה יותר רחוק מכך, אל תוצאות ורעיונות כלליים ומגניבים עוד יותר. המחיר יהיה פוסט טכני מאוד, כפי שלרוב קורה כשמתחילים לנבור בתוצאות כמו זו, אבל כל מי שיש לו ידע בסיסי כלשהו באלגברה מופשטת או תורת המספרים כנראה יוכל להבין את הרוב (אני אצטט פה ושם תוצאות בלי להוכיח, אבל גם הן לא משהו עמוק במיוחד).","headline":"סדרות לוקאס ומבחני ראשוניות","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="/assets/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon"><link type="application/atom+xml" rel="alternate" href="http://gadial.net/feed.xml" title="לא מדויק" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-3924539-2', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$latex','$'] ],
        processEscapes: true
      },
      TeX: {extensions: ["AMSmath.js","AMSsymbols.js"]},
      "HTML-CSS": { 
        linebreaks: { automatic: true }
      },
      SVG: { 
        linebreaks: { automatic: true } 
      }
    });
  </script>
  <!-- "https://www.gadial.net/wp-includes/js/xypic.js" -->

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  
</head>
<body><header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">לא מדויק</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav mr-auto">
        
            
            <li class="nav-item">
                <a class="nav-link" href="/whats_going_on">מה הולך פה?</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/">דף הבית</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/categories">קטגוריות</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/random">דף אקראי</a>
            </li>
            
        
            
            <li class="nav-item">
                <a class="nav-link" href="/about/">אודות</a>
            </li>
            
        
      </ul>
      <form class="form-inline mt-2 mt-md-0" action="/post_list/" method="get">
        <input class="form-control mr-sm-2" type="text" placeholder="חיפוש" aria-label="חיפוש" name="s">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">חיפוש</button>
      </form>
    </div>
  </nav>
</header><main class="page-content" aria-label="Content" role="main">
      <div class="wrapper text-right">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"><div class="PageNavigation">
    
      <a class="prev" href="/2016/11/05/perfect_numbers_and_mersenne_primes/">&laquo; מספרים מושלמים וראשוניי מרסן</a>
    
    
      <a class="next" href="/2016/11/30/csb_theorem_hilbert_hotel_style/">משפט קנטור-שרדר-ברנשטיין - ועכשיו בגרסת המלון של הילברט! &raquo;</a>
    
  </div><header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">סדרות לוקאס ומבחני ראשוניות</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2016-11-22T14:43:35+00:00" itemprop="datePublished">Nov 22, 2016
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>בפוסט הקודם התעסקתי בראשוניי מרסן והקשר הקרוב שלהם למספרים מושלמים. זה עשה לי חשק לדבר על עוד סיבה שבגללה ראשוניי מרסן הם מעניינים, אולי הסיבה הבולטת ביותר למי שלא מתעסקים במתמטיקה ונתקלים מדי פעם בכותרות בעיתונים: יש מבחן לבדיקת ראשוניות של מספרי מרסן שהוא <strong>יעיל בצורה יוצאת דופן</strong> ובזכותו הצלחנו לגלות מספרים ראשוניים שהם גדולים משמעותית ממה שכל שיטה אחרת מניבה לנו. בכל פעם בחמישים ומשהו השנים האחרונות שבה זעקו הכותרות על “התגלה הראשוני הגדול ביותר אי פעם!” זה היה ראשוני מרסן, שהתגלה באמצעות מבחן הראשוניות הזה, שנקרא <strong>מבחן לוקאס-להמר</strong> (כנראה שיש לכתוב “לוקה” כי כך מבטאים את השם, אבל “לוקאס” הוא הכתיב הפופולרי בעברית עבור המתמטיקאי הספציפי הזה). המבחן פשוט בצורה קיצונית, ולכן אציג אותו כמעט מייד; שארית הפוסט תעסוק בשאלה למה המבחן עובד, אבל תלך הרבה יותר רחוק מכך, אל תוצאות ורעיונות כלליים ומגניבים עוד יותר. המחיר יהיה פוסט טכני מאוד, כפי שלרוב קורה כשמתחילים לנבור בתוצאות כמו זו, אבל כל מי שיש לו ידע בסיסי כלשהו באלגברה מופשטת או תורת המספרים כנראה יוכל להבין את הרוב (אני אצטט פה ושם תוצאות בלי להוכיח, אבל גם הן לא משהו עמוק במיוחד).</p>

<p>המבחן מתבסס על סדרת מספרים שנקראת <strong>סדרת לוקאס-להמר</strong> ומתחילה כך: <span>$latex 4,14,194,37634,1416317954$</span>. הנוסחה שלה פשוטה מאוד: <span>$latex a_{0}=4$</span> ו-<span>$latex a_{n+1}=a_{n}^{2}-2$</span>. כלומר, כל איבר מתקבל על ידי העלאה בריבוע של קודמו וחיסור 2. כעת, למבחן: אם <span>$latex p$</span> הוא מספר ראשוני אז מספר מרסן <span>$latex M_{p}=2^{p}-1$</span> הוא ראשוני אם ורק אם <span>$latex a_{p-2}$</span> מתחלק ב-<span>$latex M_{p}$</span>. לכן רק צריך לחשב את <span>$latex a_{p-2}$</span> ולבדוק. בפועל החישוב הזה לא טריוויאלי לגמרי - מהר מאוד האיברים של לוקאס-להמר הופכים לענקיים בגודלם, אבל מצד שני לא צריך לזכור את כל האיבר אלא רק את השארית שלו בחלוקה ב-<span>$latex M_{p}$</span> ויש עוד תעלולים שלא אכנס אליהם כאן. השורה התחתונה היא שזה אלגוריתם יעיל מאוד.</p>

<p>אתם עשויים לשאול למה אני דורש ש-<span>$latex p$</span> יהיה ראשוני דווקא. הסיבה לכך פשוטה: אם <span>$latex n$</span> הוא מספר פריק, אז אין סיכוי ש-<span>$latex 2^{n}-1$</span> יהיה ראשוני. כי נניח ש-<span>$latex n=ab$</span> אז <span>$latex 2^{ab}-1=\left(2^{a}\right)^{b}-1$</span> וכשניקח את המשוואה הזו מודולו <span>$latex 2^{a}-1$</span>, נקבל <span>$latex 2^{a}\equiv1$</span> ולכן נקבל <span>$latex 1^{b}-1\equiv0$</span>, כלומר <span>$latex 2^{a}-1$</span> מחלק את <span>$latex 2^{n}-1$</span> (וכך גם <span>$latex 2^{b}-1$</span> ולכן עבור <span>$latex n$</span> לא ראשוני נמצא מחלק לא טריוויאלי של <span>$latex 2^{n}-1$</span>). לא הבנתם מה עשיתי פה? זו הייתה בדיקה כדי לראות אם אתם מכירים את מושגי היסוד שיהיו הכרחיים בהמשך הפוסט. לכל הפחות יהיה צורך להכיר <a href="http://www.gadial.net/2013/05/13/modular_arithmetic/">חשבון מודולרי</a>.</p>

<p>האלגוריתם הזה נראה כמו קסם. מאיפה בכלל צצה הסדרה הזו של לוקאס-להמר? איך ייתכן שתנאי כל כך פשוט כמו חלוקה מספיק בשביל לבדוק ראשוניות? איך בכלל מתחילים להוכיח משהו כזה? ובכן, האלגוריתם הזה הוא מקרה פרט של מבחן כללי יותר שמשתמש בקשר המעניין שיש בין ראשוניים ובין סדרות שמקיימות נוסחאות נסיגה מסויימות - סדרות שנקראות <strong>סדרות לוקאס</strong>. לוקאס-להמר הוא מה שמתקבל מהמבחן הזה כשהראשוניים הם מהצורה המאוד פשוטה של מספרי מרסן, וסדרת הלוקאס שבה משתמשים נבחרת בקפידה כדי להתאים למקרה הזה. ננסה להבין את הסיטואציה הכללית ואז נקטוף בסוף את לוקאס-להמר בתור מקרה פרטי.</p>

<p>הסיפור מתחיל ונגמר בסדרות לוקאס המדוברות. אלו סדרות של מספרים שלמים, שאסמן ב-<span>$latex u_{0},u_{1},u_{2},\dots$</span> שמקיימות את נוסחת הנסיגה <span>$latex u_{n}=au_{n-1}-bu_{n-2}$</span> כאשר <span>$latex a,b$</span> הם פרמטרים שלמים. הסדרה הידועה ביותר שהיא סדרת לוקאס היא סדרת <strong>מספרי פיבונאצ'י</strong> שמוגדרת על ידי <span>$latex F_{0}=0,F_{1}=1$</span> ו-<span>$latex F_{n}=F_{n-1}+F_{n-2}$</span>, כלומר זו סדרת לוקאס עם פרמטרים <span>$latex a=1,b=-1$</span> ותנאי התחלה <span>$latex F_{0}=0$</span> ו-<span>$latex F_{1}=1$</span>. יש עוד סדרות מספרים שמקיימות נוסחת נסיגה מסוג זה - למשל, מספרי מרסן בעצמם:</p>

<p><span>$latex M_{n}=2^{n}-1=3\left(2^{n-1}-1\right)-2\left(2^{n-2}-1\right)=3M_{n-1}-2M_{n-2}$</span></p>

<p>כלומר כאן <span>$latex a=3,b=2$</span> ותנאי ההתחלה הם <span>$latex M_{0}=0,M_{1}=1$</span>.</p>

<p>אם כי, כפי שנראה בהמשך, הסיבה לקיום מבחן הראשוניות המוצלח למספרי מרסן לא קשורה ישירות לכך שהם בעצמם מהווים סדרת לוקאס.</p>

<p>לא ממש הגבלתי את תנאי ההתחלה האפשריים עבור סדרות לוקאס, אבל מסתבר שהסדרות המעניינות ביותר מתקבלות עבור שני סטים אפשריים של ערכי התחלה. ראשית, ערכי ההתחלה <span>$latex u_{0}=0,u_{1}=1$</span> שנתנו לנו את פיבונאצ’י ואת מרסן, ושנית - תנאי ההתחלה <span>$latex u_{0}=2$</span> ו-<span>$latex u_{1}=a$</span> (כאשר <span>$latex a$</span> הוא הפרמטר שמגדיר את נוסחת הנסיגה: <span>$latex u_{n}=au_{n-1}-bu_{n-2}$</span>). בינתיים אדבר על סדרות שמתקבלות מתנאי ההתחלה הראשון. נתחיל בלראות משהו מגניב שקורה ספציפית בפיבונאצ’י, ואז נכליל אותו.</p>

<p>הדבר המגניב הוא זה: אם <span>$latex n$</span> הוא מספר ראשוני, אז <span>$latex n$</span> חייב לחלק את מספר פיבונאצ’י במקום שהוא “כמעט <span>$latex n$</span>”. מה זאת אומרת “כמעט”? או שזה יהיה המספר במקום ה-<span>$latex n$</span>, או שזה יהיה המספר במקום ה-<span>$latex n+1$</span> או שזה יהיה המספר במקום ה-<span>$latex n-1$</span>. זה תלוי בתכונה כלשהי של <span>$latex n$</span>. במפורש:</p>
<ul>
	<li>אם <span>$latex n$</span> מתחלק ב-<span>$latex 5$</span> אז <span>$latex n$</span> מחלק את <span>$latex F_{n}$</span>.</li>
	<li>אם <span>$latex n$</span> מחזיר שארית 1 או 4 בחלוקה ב-5 אז <span>$latex n$</span> מחלק את <span>$latex F_{n-1}$</span>.</li>
	<li>אם <span>$latex n$</span> מחזיר שארית 2 או 3 בחלוקה ב-5 אז <span>$latex n$</span> מחלק את <span>$latex F_{n+1}$</span>.</li>
</ul>
<p>בואו נראה דוגמאות. נכתוב את האיברים הראשונים של פיבונאצ’י: <span>$latex 0,1,1,2,3,5,8,13,21,34,55$</span>. עכשיו בואו נעבור על ראשוניים: 2 מחזיר שארית 2 בחלוקה ב-<span>$latex 5$</span> ואכן מחלק את <span>$latex F_{3}=2$</span>. 3 אכן מחלק את <span>$latex F_{4}=3$</span>. 5 אכן מחלק את <span>$latex F_{5}=5$</span>. 7 אכן מחלק את <span>$latex F_{8}=21$</span>. 11 אכן מחלק את <span>$latex F_{10}=55$</span>, וזה נמשך ונמשך ונמשך. זו תוצאה ממש נחמדה! האם היא מספיקה כדי <strong>להוכיח</strong> שמספר הוא ראשוני? ובכן, לא: אפשר להראות, למשל, ש-323 מחלק את <span>$latex F_{324}$</span> אבל הוא לא ראשוני כי <span>$latex 323=17\cdot19$</span>. לכן למספר שמקיים את הקריטריון הזה קוראים <strong>פסאודוראשוני פיבונאצ'י</strong>. לא כדאי לזלזל במבחנים שבודקים אם מספר הוא פסאודוראשוני: זו דרך מאוד טובה לסנן מספרים פריקים לפני שזורקים עליהם אלגוריתם שיודע להוכיח ראשוניות והוא כנראה כבד יחסית. מבחן פסואודוראשוניות אחד כנראה לא יהיה מספיק, אבל אם משלבים כמה מקבלים סינון אפקטיבי מאוד.</p>

<p>עכשיו בואו נוריד חלק מהמיסטיקה סביב הניסוח של המשפט הזה. ה”כמעט במקום ה-<span>$latex n$</span>” הוא מעצבן כי הוא מייצר חלוקה למקרים שנראית שרירותית מאוד, אבל בפועל היא לא שרירותית בכלל: היא תלויה בשאלה האם <span>$latex n$</span> הוא <strong>שארית ריבועית</strong> מודולו <span>$latex 5$</span>. יש לי <a href="http://www.gadial.net/2009/06/26/sums_of_squares_and_quadratic_reciprocity/">פוסט בנושא</a> אבל הנה תזכורת: מספר <span>$latex a$</span> הוא שארית ריבועית מודולו <span>$latex n$</span> אם הוא ריבוע ב-<span>$latex \mathbb{Z}_{n}^{*}$</span>, כלומר אם למשוואה <span>$latex x^{2}=n$</span> קיים פתרון ב-<span>$latex \mathbb{Z}_{n}^{*}$</span>. ספציפית עבור <span>$latex z=5$</span> קל לראות שעבור 1 ו-4 יש פתרונות (1 ו-2, כמובן) אבל עבור 2 ו-3 אין פתרונות (כי 3 בריבוע מודולו 5 נותן 4 ואילו 4 בריבוע נותן 1 - אלו השורשים הנוספים שיש ל-1 ו-4, כי בשדה כמו <span>$latex \mathbb{Z}_{5}$</span> אם למספר יש שורש יש לו בדיוק שני שורשים). שימו לב שההגדרה שלי דיברה על <span>$latex \mathbb{Z}_{n}^{*}$</span>, כלומר על אוסף כל המספרים <strong>שזרים</strong> ל-5; לכן המקרה של <span>$latex n$</span> מתחלק ב-5 הוא מיוחד.</p>

<p>כעת, יש סימון מקובל לתיאור האם מספר הוא שארית ריבועית או לא, שהתגלה כשימושי במיוחד והוא שימושי גם כאן: אם <span>$latex p$</span> ראשוני ו-<span>$latex n$</span> הוא מספר כלשהו, אז <span>$latex \left(\frac{n}{p}\right)=1$</span> אם <span>$latex n$</span> הוא שארית ריבועית מודולו <span>$latex p$</span>, <span>$latex \left(\frac{n}{p}\right)=-1$</span> אם <span>$latex n$</span> הוא לא שארית ריבועית אבל זר ל-<span>$latex p$</span>, ואילו <span>$latex \left(\frac{n}{p}\right)=0$</span> אם <span>$latex n$</span> לא זר ל-<span>$latex p$</span>. לסימן הזה קוראים <strong>סימן לז'נדר</strong> (ובמקרה שבו ה”מכנה” הוא לא ראשוני, קוראים לו <strong>סימן יעקובי</strong>). צריך כמובן לומר במפורש שהסימן הזה <strong>לא מתאר שבר</strong>. קו השבר בין <span>$latex n$</span> ל-<span>$latex p$</span> הוא סתם סימון, ומההקשר מבינים שלא מדובר על שבר. עכשיו אפשר לנסח את המשפט בצורה קצת יותר קומפקטית: אם <span>$latex n$</span> הוא ראשוני, אז <span>$latex n$</span> מחלק את <span>$latex F_{n-\left(\frac{n}{5}\right)}$</span>. הנה, הסימון כבר מתחיל לעבוד לטובתנו.</p>

<p>עד עכשיו נראה היה שתיארתי תכונה מעניינת <strong>של סדרת פיבונאצ'י</strong>. אבל בפועל מדובר על תכונה מעניינת של סדרות לוקאס באופן כללי - ליתר דיוק, אלו עם תנאי ההתחלה 0,1. הנה המשפט הכללי: תהא <span>$latex U_{k}$</span> סדרת לוקאס עם תנאי התחלה <span>$latex 0,1$</span> ונוסחת נסיגה <span>$latex U_{k}=aU_{k-1}-bU_{k-2}$</span>. נסמן <span>$latex \Delta=a^{2}-4b$</span>. אם <span>$latex p$</span> הוא מספר ראשוני שזר ל-<span>$latex 2b\Delta$</span> אז <span>$latex p$</span> מחלק את <span>$latex U_{p-\left(\frac{\Delta}{p}\right)}$</span>.</p>

<p>מה קורה אצל פיבונאצ’י? במקרה הזה <span>$latex a=1,b=-1$</span> ולכן <span>$latex \Delta=1^{2}+4=5$</span> - מכאן הגיע ה-5 הזה. כעת, <span>$latex 2b\Delta=10$</span> ולכן כל ראשוני פרט ל-<span>$latex 2,5$</span> זר ל-<span>$latex 2b\Delta$</span> (ועבורם המשפט עובד בכל מקרה כאן). לכן המסקנה היא ש-<span>$latex p$</span> מחלק את <span>$latex U_{p-\left(\frac{5}{p}\right)}$</span>. זה נראה <strong>כמעט</strong> כמו המשפט על פיבונאצ’י רק ששמשהו התהפך כאן: כתוב <span>$latex \left(\frac{5}{p}\right)$</span> במקום <span>$latex \left(\frac{p}{5}\right)$</span>. הסיבה לכך שאפשר לבצע את ההיפוך הזה היא משפט נפלא שנקרא <strong>משפט ההדדיות הריבועית</strong> שאומר שאם <span>$latex p,q$</span> הם ראשוניים אז <span>$latex \left(\frac{p}{q}\right)\left(\frac{q}{p}\right)=\left(-1\right)^{\left(\frac{p-1}{2}\right)\left(\frac{q-1}{2}\right)}$</span>, ובמילים: אם <span>$latex p$</span> או <span>$latex q$</span> שקולים ל-1 מודולו 4 אז <span>$latex \left(\frac{p}{q}\right)=\left(\frac{q}{p}\right)$</span>, ואם שניהם שקולים ל-3 מודולו 4 אז <span>$latex \left(\frac{p}{q}\right)=-\left(\frac{q}{p}\right)$</span>. מכיוון ש-<span>$latex 5$</span> שקול ל-1 מודולו 4 אנחנו במקרה הראשון ולכן ניתן “להפוך” כפי שהפכנו.</p>

<p>עכשיו לשאלה המעניינת - למה המשפט הכללי נכון? כאן מגיעים הניסים והנפלאות. הרעיון הבסיסי יהיה לחשוב על אברי הסדרה <span>$latex U_{k}$</span> לא בתור “סתם” מספרים שלמים, אלא בתור יצורים שחיים בתוך מרחב גדול יותר - <strong>השדה הסופי</strong> <span>$latex \mathbb{F}_{p^{2}}$</span>. תכף אסביר בדיוק על מה מדובר, אבל לפני כן אני רוצה להתלהב מהרעיון הכללי כאן. זו תופעה מאוד נפוצה במתמטיקה בכלל, ובתורת המספרים בפרט: יש לנו אובייקט שאנחנו מסוגלים להבין אינטואיטיבית, אבל פתאום צצות תכונות יפהפיות שלו שאין לנו מושג איך להסביר באמצעות התיאור הרגיל שלנו של האובייקט. רק כשאנחנו מתחילים לחשוב על האובייקט בתור משהו שחי בעולם גדול יותר, ומסובך יותר, ואולי גם נוגד אינטואיציה הרבה יותר, פתאום התכונות מתחילות לצוץ כמעט מאליהן. זה מתרחש בגלל שהאובייקט שלנו מקיים יחסי גומלין עם האובייקטים של העולם הגדול והמסובך יותר, גם אם מבחינתנו זה שקוף לחלוטין כל עוד אנחנו נשארים בחיק החמים של האינטואיציה שלנו, שמסתירה מפנינו את העולם הגדול יותר. כמה פעמים שמעתם מישהו אומר ש”הוא לא מבין למה מספרים מרוכבים הם מספרים בכלל”? זו דוגמת האבטיפוס: יש שלל תכונות שהדרך הנכונה להבין מדוע המספרים הממשיים/השלמים מקיימים אותן שצצות רק כשחושבים על המספרים הללו בתור יצורים שחיים בשדה המספרים המרוכבים. למרוכבים לא אכפת אם אתם מקבלים אותם או לא; הם קיימים, והם מרתקים, וגם אם אנחנו מנסים לאטום את החלון ולא לראות אותם, מדי פעם קרני שמש חודרות מבעד למעטה שלנו ונופלות על אותו חלק קטן מהמספרים המרוכבים שאנחנו מוכנים ברוב טובנו להכיר בקיומו.</p>

<p>טוב, מספיק עם הפילוסופיה; היא דרושה כדי להכין אתכם לזבנג שאני הולך לתת עוד שניה למי שלא רגיל לנושאים הללו. כאמור, אני רוצה לחשוב על ה-<span>$latex U_{k}$</span>-ים בתור איברים בשדה סופי עם <span>$latex p^{2}$</span> איברים. <a href="http://www.gadial.net/2011/07/11/fields_and_how_can_they_be_finite/">יש לי כאן הסברים</a> על מהם שדות כאלו אז לא אכנס למלוא הפרטים כרגע. השאלה המעניינת מבחינתנו היא איך אנחנו רוצים <strong>לייצג</strong> את אברי השדה הסופי הזה. השיטה המקובלת לבנייה של שדה סופי בן <span>$latex p^{2}$</span> איברים היא זו: מתחילים מהשדה <span>$latex \mathbb{Z}_{p}=\left\{ 0,1,\dots,p-1\right\} $</span>, ולוקחים פולינום <span>$latex f\left(x\right)$</span> ממעלה שניה מעליו שהוא <strong>אי פריק</strong>, כלומר שאין לו שורש ב-<span>$latex \mathbb{Z}_{p}$</span>. ועכשיו מסתכלים על <strong>חוג המנה</strong> שמתקבל כשמחלקים את חוג הפולינומים מעל <span>$latex \mathbb{Z}_{p}$</span> באידאל שנוצר מהפולינום <span>$latex f\left(x\right)$</span>. מה זה אומר בתכל’ס? שמסתכלים על קבוצת הפולינומים מהצורה <span>$latex sx+t$</span> עם פעולות חיבור וכפל “מודולו <span>$latex f\left(x\right)$</span>” - כלומר, אחרי שמחברים או כופלים מחלקים ב-<span>$latex f\left(x\right)$</span> ולוקחים את השארית (בפועל על חיבור זה לא משפיע, רק על כפל).</p>

<p>עכשיו מגיע החלק המוזר למראה. כזכור, אנחנו מסתכלים על הסדרה <span>$latex U_{k}$</span> שמוגדרת על ידי הפרמטרים <span>$latex a,b$</span>. זה אומר שמתקיים <span>$latex U_{k+2}=aU_{k+1}-bU_{k}$</span>. בואו נשחק לרגע משחק: במקום <span>$latex U_{k+i}$</span> נכתוב <span>$latex x^{i}$</span>. כלומר, <span>$latex x^{2}=ax^{1}-bx^{0}$</span> או בקיצור <span>$latex x^{2}=ax-b$</span>. נעביר אגפים ונקבל <span>$latex x^{2}-ax+b=0$</span>. בואו נקרא לפולינום שבצד שמאל <span>$latex f\left(x\right)$</span>, כלומר <span>$latex f\left(x\right)=x^{2}-ax+b$</span>. הפולינום הזה מאפשר לנו להגדיר את הסדרה <span>$latex U_{k}$</span> בתור <strong>סדרה של פולינומים</strong> באופן הבא, שייראה לכם מאוד מוזר במבט ראשון ולכן אני מבטיח שהוא מאוד שימושי:</p>

<p><span>$latex U_{k}\triangleq\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}\left(\mbox{mod }f\left(x\right)\right)$</span></p>

<p>מה טוב בהגדרה המוזרה הזו? שזו <strong>לא הגדרה רקורסיבית</strong>. מצד שני, קל לראות שהיא מגדירה את הסדרה <span>$latex U_{k}$</span> שתיארתי קודם. בפרט, זו נראית כמו סדרה של פולינומים, אבל בפועל נקבל סדרה של מספרים שלמים. כדי לראות את זה, בואו קודם כל נציב <span>$latex k=0$</span> ונקבל</p>

<p><span>$latex U_{0}=\frac{x^{0}-\left(a-x\right)^{0}}{x-\left(a-x\right)}=\frac{1-1}{x-\left(a-x\right)}=0$</span></p>

<p>וכעת נציב <span>$latex k=1$</span> ונקבל</p>

<p><span>$latex U_{1}=\frac{x^{1}-\left(a-x\right)^{1}}{x-\left(a-x\right)}=\frac{x-\left(a-x\right)}{x-\left(a-x\right)}=1$</span></p>

<p>אז קיבלנו את הערכים ההתחלתיים שציפינו להם. כעת, למה <span>$latex U_{k}$</span> מקיים את נוסחת הנסיגה? בשביל זה צריך להבין מה המשמעות של חישובים מודולו <span>$latex f\left(x\right)$</span>. זה אומר שאנחנו יכולים להחליף כל מופע של <span>$latex x^{2}-ax+b$</span> באפס, או באופן שקול, להחליף כל מופע של <span>$latex x^{2}$</span> ב-<span>$latex ax-b$</span> וההפך. אז בואו נעשה חישובים עם הנשק החדש הזה שלנו:</p>

<p><span>$latex x^{2}=ax-b$</span></p>

<p><span>$latex \left(a-x\right)^{2}=a^{2}-2ax+x^{2}=a^{2}-2ax+\left(ax-b\right)=a^{2}-ax-b=a\left(a-x\right)-b$</span></p>

<p>ולכן:</p>

<p><span>$latex x^{k+2}=x^{k}\left(ax-b\right)=ax^{k+1}-bx^{k}$</span></p>

<p><span>$latex \left(a-x\right)^{k+2}=\left(a-x\right)^{k}\left(a-x\right)^{2}=a\left(a-x\right)^{k+1}-b\left(a-x\right)^{k}$</span></p>

<p>ומכאן:</p>

<p><span>$latex U_{k+2}=\frac{x^{k+2}-\left(a-x\right)^{k+2}}{x-\left(a-x\right)}=a\frac{x^{k+1}-\left(a-x\right)^{k+1}}{x-\left(a-x\right)}-b\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}=aU_{k+1}-bU_{k}$</span></p>

<p>כלומר, ה-<span>$latex U_{k}$</span> היא עדיין הסדרה המוכרת והאהובה עלינו, רק כתובה בצורה מוזרה עם פולינומים שבסוף בכלל לא באים לידי ביטוי כי כל האיקסים מצטמצמים. אבל הפולינומים הללו הם בדיוק ה”עולם רחב יותר” שאני מדבר עליו.</p>

<p>בואו נחזור לרגע לדבר על העולם ונראה במפורש איך מתנהגות פעולות החיבור והכפל בו. זכרו: הן מתנהגות כמו חיבור וכפל פולינומים רגיל, בתוספת היכולת שלנו להשתמש במשוואה <span>$latex x^{2}=ax-b$</span>. לכן נקבל:</p>

<p><span>$latex \left(s_{1}x+t_{1}\right)+\left(s_{2}x+t_{2}\right)=\left(s_{1}+s_{2}\right)x+\left(t_{1}+t_{2}\right)$</span></p>

<p><span>$latex \left(s_{1}x+t_{1}\right)\cdot\left(s_{2}x+t_{2}\right)=s_{1}s_{2}x^{2}+\left(s_{1}t_{2}+s_{2}t_{1}\right)x+t_{1}t_{2}=$</span></p>

<p><span>$latex \left(s_{1}t_{2}+s_{2}t_{1}+as_{1}s_{2}\right)x+\left(t_{1}t_{2}-bs_{1}s_{2}\right)$</span></p>

<p>זה ייצוג מפורש של פעולות החשבון, גם עבור מי שלא מבין את הדיבורים הגבוהים על חלוקה באידאלים של חוגי פולינומים. עכשיו אפשר לעבור לאקשן של הוכחת המשפט. המשפט, כזכור, אומר שאם <span>$latex p$</span> הוא מספר ראשוני שזר ל-<span>$latex 2b\Delta$</span> אז <span>$latex p$</span> מחלק את <span>$latex U_{p-\left(\frac{\Delta}{p}\right)}$</span>, כאשר <span>$latex \Delta=a^{2}-4b$</span>.</p>

<p>הגיע הזמן להבין מאיפה הגיע <span>$latex \Delta$</span> הזה. אולי אתם זוכרים מהתיכון שזה סימון של <strong>דיסקרימיננטה</strong>, שזה “המשהו שמתחת לשורש” בפתרון משוואה ריבועית. זה לא מקרי. ההפרדה למקרים שלנו עוסקת בדיוק בשאלה האם הפולינום <span>$latex x^{2}-ax+b$</span> הוא אי-פריק (ואז חלוקה בו נותנת שדה) או שהוא פריק (ואז עדיין אפשר להגדיר את פעולות החשבון כמו למעלה אבל נקבל משהו שאינו שדה). לשם כך משתמשים בנוסחת השורשים, שנכונה גם מעל שדות סופיים: שורשי הפולינום הזה הם <span>$latex \frac{a\pm\sqrt{a^{2}-4b}}{2}=\frac{a\pm\sqrt{\Delta}}{2}$</span> ולכן יש לפולינום הזה שורש אם ורק אם ל-<span>$latex \Delta$</span> יש שורש, כלומר אם ורק אם <span>$latex \left(\frac{\Delta}{p}\right)=1$</span> (בלתי אפשרי שיתקיים ש-<span>$latex \Delta$</span> היא 0 ב-<span>$latex \mathbb{Z}_{p}$</span> כי המשמעות של כך היא ש-<span>$latex \Delta$</span> לא זרה ל-<span>$latex p$</span>, בניגוד להנחה שלנו).</p>

<p>אם <span>$latex \left(\frac{\Delta}{p}\right)=-1$</span>, כלומר <span>$latex \Delta$</span> איננו ריבוע, קיבלנו שאוסף הפולינומים שלנו מודולו <span>$latex f\left(x\right)$</span> הוא שדה. עכשיו מגיע השלב שבו אנחנו מגלים שמשתלם לנו לחשוב לא רק על מספרים שלמים אלא גם על עולם רחב יותר מזה - אפשר להשתמש בידע שיש לנו בתורת השדות. ספציפית, הידע הזה מלמד אותנו במקרה הזה שבתוך השדה שלנו, <span>$latex x^{p}=a-x$</span> ואילו <span>$latex \left(a-x\right)^{p}=x$</span>. למה? ובכן, ראשית נשים לב לכך שבתוך השדה שבנינו, <span>$latex x$</span> הוא שורש של הפולינום <span>$latex f\left(t\right)=t^{2}-at+b$</span> (אני כותב אותו בכוונה עם <span>$latex t$</span> הפעם כדי לא ליצור בלבול - ה-<span>$latex x$</span> הוא איבר של ממש בשדה, בעוד שסימון המשתנה שאיתו אנחנו בוחרים לתאר פולינום הוא לגמרי בשליטתנו). כמו כן, אפשר לראות שגם <span>$latex a-x$</span> הוא שורש של הפולינום הזה, על ידי הצבה ישירה:</p>

<p><span>$latex \left(a-x\right)^{2}-a\left(a-x\right)+b=a^{2}-2ax+x^{2}-a^{2}+ax+b=-ax+ax-b+b=0$</span></p>

<p>עכשיו, תוצאה בסיסית בתורת השדות היא שבהינתן שדה סופי <span>$latex \mathbb{F}_{p^{k}}$</span>, הפונקציה <span>$latex a\mapsto a^{p}$</span> היא <strong>אוטומורפיזם</strong> של השדה, שזוכה לשם המיוחד <strong>אוטומורפיזם פרובניוס</strong>. ידוע גם שהפונקציה הזו היא הזהות בדיוק על שדה הבסיס <span>$latex \mathbb{F}_{p}=\mathbb{Z}_{p}$</span>, ואנחנו יודעים בדיוק מה עושה אוטומורפיזם של שדה <span>$latex E$</span> שהוא הזהות בדיוק על שדה הבסיס <span>$latex F$</span>, כשנותנים לו שורשים של פולינומים שהמקדמים שלהם כולם מתוך <span>$latex F$</span>: הוא חייב לבצע <strong>פרמוטציה</strong> של השורשים הללו. כלומר, חופש הבחירה של האוטומורפיזם לאן הוא רוצה לשלוח את השורשים מוגבל לשורשים אחרים של אותו הפולינום. האבחנה הזו היא הבסיס לתורת גלואה, אבל לא אכנס לכך כרגע. השורה התחתונה היא שלמי שיש נסיון בתורת השדות ברור כמעט מייד שיתקיימו שני השוויונות שכתבתי למעלה. וזה אומר את הדבר הבא:</p>

<p><span>$latex U_{p+1}=\frac{x^{p+1}-\left(a-x\right)^{p+1}}{x-\left(a-x\right)}=\frac{x\left(a-x\right)-\left(a-x\right)x}{x-\left(a-x\right)}=0$</span></p>

<p>כלומר, <span>$latex U_{p+1}$</span> מתחלק ב-<span>$latex p$</span>, בדיוק כפי שרצינו.</p>

<p>המקרה השני, <span>$latex \left(\frac{\Delta}{p}\right)=1$</span>, הוא קצת שונה אבל בצורה שהופכת אותו לפשוט יותר. במקרה הזה אוסף הפולינומים שלנו לא מהווה שדה אלא “סתם” חוג - אז איזה חוג זה? בעזרת <a href="http://www.gadial.net/2012/09/12/chinese_remainder_theorem/">משפט השאריות הסיני</a> בגרסה מוכללת שלו אפשר להראות שאם מחלקים חוג <span>$latex R$</span> במכפלה של אידאלים <span>$latex IJ$</span> אז מקבלים את המכפלה של חלוקת החוג בכל אידאל בנפרד, כלומר <span>$latex R/IJ\cong R/I\times R/J$</span>. במקרה שלנו אנחנו מחלקים באידאל שנוצר על ידי פולינום; אם הפולינום מתפרק, אפשר לכתוב את האידאל שהוא יוצר בתור מכפלת האידאלים של המרכיבים של הפירוק. כל אחד מהם הוא פולינום ממעלה 1 ולכן החוג שמתקבל מחלוקה בהם איזומורפי לחוג המקורי. כל להטוטי האלגברה הללו מובילים למסקנה הפשוטה: במקרה השני החוג שלנו הוא <span>$latex \mathbb{Z}_{p}\times\mathbb{Z}_{p}$</span>. החוג הזה נחמד מאוד כי קל לראות שכאשר מעלים איבר <strong>כלשהו</strong> בו בחזקת <span>$latex p$</span> מקבלים חזרה את האיבר המקורי. לכן במקרה הזה <span>$latex x^{p}=x$</span> ו-<span>$latex \left(a-x\right)^{p}=a-x$</span> ולכן אחרי צמצום (צריך לנמק למה אפשר לצמצם את האיברים הללו - נסו!) מקבלים <span>$latex x^{p-1}=\left(a-x\right)^{p-1}=1$</span> ואנחנו מקבלים:</p>

<p><span>$latex U_{p-1}=\frac{x^{p-1}-\left(a-x\right)^{p-1}}{x-\left(a-x\right)}=\frac{1-1}{x-\left(a-x\right)}=0$</span></p>

<p>כלומר <span>$latex U_{p-1}$</span> מתחלק ב-<span>$latex p$</span>, כפי שרצינו.</p>

<p>סיימנו את ההוכחה של משפט מאוד נחמד שנותן לנו מבחן של פסאודוראשוניות, אבל בואו נתאפס לרגע - התחלנו את הפוסט הזה עם אלגוריתם לוקאס-להמר ואנחנו עדיין ממש לא שם. על פניו כל מה שעשינו כרגע בכלל לא היה קשור. בפועל אנחנו כבר מאוד קרובים אל לוקאס-להמר, אבל לפני כן אני צריך להציג מבחן כללי יותר שיכול להוכיח ראשוניות - נקרא לו “מבחן ה-<span>$latex n+1$</span>”. לוקאס-להמר יתקבל בתור מקרה פרטי נחמד במיוחד שלו.</p>

<p>המבחן אומר את הדבר הבא: בואו ניקח <span>$latex f\left(x\right)=x^{2}-ax+b$</span> כמו קודם ונסמן <span>$latex \Delta=a^{2}-4b$</span> כמו קודם, וניקח מספר <span>$latex n$</span> חיובי כלשהו שהוא זר ל-<span>$latex 2b$</span> ומקיים <span>$latex \left(\frac{\Delta}{n}\right)=-1$</span>. ראשית כל נבדוק האם <span>$latex U_{n+1}$</span> מתחלק ב-<span>$latex n$</span>, כמו קודם: אם <span>$latex n$</span> ראשוני זה חייב להתקיים. אבל זה לא מספיק כדי להוכיח שהוא ראשוני. אבל אפשר לחזק את זה: בואו ניקח מחלק <strong>כלשהו</strong> של <span>$latex n+1$</span> ונסמן אותו ב-<span>$latex F$</span>. נניח שאנחנו מכירים את הפירוק לגורמים ראשוניים של <span>$latex F$</span>. לכל גורם ראשוני <span>$latex q$</span> של <span>$latex F$</span>, נבדוק אם <span>$latex U_{\frac{n+1}{q}}$</span> זר ל-<span>$latex n$</span>. אם כן, זה מוכיח שלכל <span>$latex p$</span> ראשוני שמחלק את <span>$latex n$</span> מתקיים <span>$latex p\equiv\left(\frac{\Delta}{p}\right)$</span> מודולו <span>$latex F$</span>.</p>

<p>רגע, מה? המסקנה של המשפט ממש לא ברורה. את מי זה מעניין? ובכן עבור ערכים קטנים של <span>$latex F$</span> זה לא כל כך מעניין. אבל נניח ש-<span>$latex n$</span> לא ראשוני ולקחנו <span>$latex F&gt;\sqrt{n}+1$</span>, אז בהכרח <strong>כל</strong> הגורמים הראשוניים של <span>$latex n$</span> יהיו קטנים מ-<span>$latex F$</span>, ולכן מודולו <span>$latex F$</span> יהיו שווים לעצמם. מה שאומר שהמשוואה <span>$latex p\equiv\left(\frac{\Delta}{p}\right)$</span> לא תוכל להתקיים בכלל. מכאן שאם מצאנו <span>$latex F&gt;\sqrt{n}+1$</span> שמקיים את הבדיקה שלעיל (<span>$latex U_{\frac{n+1}{q}}$</span> זר ל-<span>$latex n$</span> לכל <span>$latex q$</span> ראשוני שמחלק את <span>$latex F$</span>), זה מוכיח ש-<span>$latex n$</span> ראשוני.</p>

<p>למה זה נכון? ובכן, ראשית בואו נסמן ב-<span>$latex r_{f}\left(n\right)$</span> את האינדקס של המספר הראשון בסדרה <span>$latex U_{k}$</span> שמתחלק ב-<span>$latex n$</span>. קוראים לזה <strong>דרגת ההופעה</strong> של <span>$latex n$</span>. אפשר להוכיח עם קצת עבודה טכנית שאדלג עליה שדרגת ההופעה של <span>$latex n$</span> מחלקת כל מופע אחר של <span>$latex n$</span>: דהיינו, <span>$latex U_{k}$</span> כלשהו מתחלק ב-<span>$latex n$</span> אם ורק אם <span>$latex k$</span> מתחלק ב-<span>$latex r_{f}\left(n\right)$</span>. ניקח עכשיו מספר ראשוני <span>$latex p$</span> שמחלק את <span>$latex n$</span>: המשפט שראינו קודם אמר שאם <span>$latex p$</span> ראשוני אז הוא מחלק את <span>$latex U_{p-\left(\frac{\Delta}{p}\right)}$</span>. כלומר, קיבלנו ש-<span>$latex r_{f}\left(p\right)$</span> מחלק את <span>$latex p-\left(\frac{\Delta}{p}\right)$</span>, ובניסוח שקול: <span>$latex p\equiv\left(\frac{\Delta}{p}\right)$</span> מודולו <span>$latex r_{f}\left(p\right)$</span> מתקיים תמיד. זו המשוואה שרצינו להגיע אליה, אבל לא מודולו <span>$latex r_{f}\left(p\right)$</span> אלא מודולו מחלק <span>$latex F$</span> של <span>$latex n+1$</span> שמקיים כך-וכך. לצורך כך יספיק לנו להוכיח ש-<span>$latex F$</span> שמקיים כך-וכך מחלק את <span>$latex r_{f}\left(p\right)$</span> (כי אם <span>$latex F$</span> מחלק את <span>$latex r_{f}\left(p\right)$</span> הוא מחלק גם כל דבר שמתחלק על ידי <span>$latex r_{f}\left(p\right)$</span>).</p>

<p>בואו נזכור מה הכך-וכך ש-<span>$latex F$</span> מקיים. ראשית, <span>$latex U_{n+1}$</span> מתחלק ב-<span>$latex n$</span> ולכן בפרט מתחלק ב-<span>$latex p$</span>, ואנחנו יודעים ש-<span>$latex F$</span> מחלק את <span>$latex n+1$</span>. אם היינו יכולים לטעון משהו כמו <span>$latex r_{f}\left(p\right)=n+1$</span> היינו מסיימים כאן. אבל זה לא בהכרח נכון. אנחנו יודעים שבגלל ש-<span>$latex p$</span> מחלק את <span>$latex U_{n+1}$</span> אז <span>$latex r_{f}\left(p\right)$</span> <strong>מחלק</strong> את <span>$latex n+1$</span>, אבל הוא לא חייב להיות שווה לו. אני חושב שהכי ברור להציג את הסיטואציה הזו באופן הבא: אפשר לכתוב את הפירוק לגורמים של <span>$latex n+1$</span>: <span>$latex n+1=q_{1}^{k_{1}}\cdots q_{t}^{k_{t}}$</span>. כעת, המשמעות של “<span>$latex r_{f}\left(p\right)$</span> מחלק את <span>$latex n+1$</span>” הוא שיש ל-<span>$latex r_{f}\left(p\right)$</span> <strong>את אותו פירוק לגורמים אבל עם חזקות שהן אולי נמוכות יותר</strong>. במילים אחרות, אפשר להגיע מ-<span>$latex n+1$</span> אל <span>$latex r_{f}\left(p\right)$</span> על ידי סדרה של צעדים, שבכל אחד מהם אנחנו לוקחים גורם ראשוני <span>$latex q$</span> של <span>$latex n+1$</span> ומחלקים את המספר שיש לנו ביד כרגע בגורם הזה. והנה הפאנץ’: כל עוד הגורם <span>$latex q$</span> הזה <strong>איננו</strong> גורם של <span>$latex F$</span>, אז <span>$latex F$</span> ימשיך לחלק את התוצאה שלנו (כי אנחנו לא מקטינים את החלק של <span>$latex F$</span> בתוך <span>$latex n+1$</span>).</p>

<p>כאן נכנס לתמונה התנאי הנוסף שאנחנו בודקים: אם עבור גורם <span>$latex q$</span> של <span>$latex F$</span> מתקיים ש-<span>$latex U_{\frac{n+1}{q}}$</span> זר ל-<span>$latex n$</span>, אז בפרט הוא לא מתחלק על ידי אף גורם של <span>$latex n$</span>, כלומר <span>$latex p$</span> לא מחלק את <span>$latex U_{\frac{n+1}{q}}$</span>. זה <strong>מבטיח</strong> שלא ייתכן ש-<span>$latex r_{f}\left(p\right)$</span> יחלק את <span>$latex \frac{n+1}{q}$</span> כי אמרנו שאם אינדקס ההופעה של <span>$latex p$</span> מחלק אינדקס אחר, אז <span>$latex p$</span> מופיע גם באינדקס הזה (דהיינו, <span>$latex p$</span> מחלק את <span>$latex U$</span> עבור האינדקס הזה). המסקנה היא שבמעבר מ-<span>$latex n+1$</span> אל <span>$latex r_{f}\left(p\right)$</span> אנחנו לא מחלקים אף פעם ב-<span>$latex q$</span>, עבור אף <span>$latex q$</span> שהוא מחלק של <span>$latex F$</span>. לכן התוצאה שנקבל בסוף, שהיא <span>$latex r_{f}\left(p\right)$</span>, מתחלקת ב-<span>$latex F$</span> וסיימנו את ההוכחה הזו.</p>

<p>יפה, עוד עצירה לצורך השבת הנשימה והתמקדות מה שכבר עשינו ומה שנשאר לעשות. מה שעשינו היה להוכיח מבחן הוכחת ראשוניות כללי, שנקרא “מבחן ה-<span>$latex n+1$</span>”. אני אומר “מבחן <strong>הוכחת</strong> ראשוניות” כי המבחן הזה לא יודע להוכיח שמספר הוא <strong>לא</strong> ראשוני; הוא רק יודע להוכיח, עבור חלק מהמספרים הראשוניים, שהם אכן כאלו. למבחן הזה יש חיסרון בולט - צריך להכיר את הפירוק לגורמים של <span>$latex n+1$</span>, ובאופן כללי בעיית הפירוק לגורמים היא קשה משמעותית יותר מבעיית בדיקת הראשוניות. עדיין, זה שמדובר על בעיה קשה לא אומר שלפעמים לא קל לפרק מספרים לגורמים. נניח שיש לכם מספר <span>$latex n$</span> שממש קריטי עבורכם להוכיח שהוא ראשוני והאלגוריתמים הרגילים רצים ורצים עליו ולא מסיימים - אין שום סיבה לא לתת למבחן ה-<span>$latex n+1$</span> הזדמנות, אולי במזל יוצא שאת <span>$latex n+1$</span> דווקא קל לפרק לגורמים במקרה הזה ואז אפשר יהיה להשתמש במבחן. כל כלי נוסף שמאפשר לנו להוכיח ראשוניות הוא דבר טוב.</p>

<p>אבל פרט להצדקות הכלליות הללו, המבחן מן הסתם מעניין במיוחד במקרה שבו <span>$latex n+1$</span> הוא מספר פשוט במיוחד, ואין סיטואציה פשוטה יותר מאשר זו שבה <span>$latex n$</span> הוא מספר מרסן, כלומר <span>$latex n=2^{k}-1$</span>. במקרה הזה, <span>$latex n+1$</span> הוא פשוט חזקה של 2. לא רק שאנחנו יודעים לפרק אותה עד הסוף, יש לנו גם גורם יחיד, וגורם שהוא בסיסי מאוד. זה לגמרי מזמין נסיון להוכיח שבמקרה הספציפי הזה, אפשר לעשות יותר מסתם להוכיח ראשוניות בחלק מהמקרים - אנחנו הרי רוצים מבחן שעונה תשובה ודאית של כן/לא.</p>

<p>בשביל לבצע את הצעד האחרון, אנחנו צריכים וריאציה על מבחן ה-<span>$latex n+1$</span> שהיא <strong>טיפ-טיפה</strong> יותר מתאימה לנו. בשביל לעשות את זה, אנחנו מכניסים לתמונה סוג חדש של סדרת לוקאס שהזכרתי בחטף בתחילת הפוסט: סדרה <span>$latex V_{k}$</span> שגם היא מוגדרת בעזרת נוסחת נסיגה <span>$latex V_{k+2}=aV_{k+1}-bV_{k}$</span>, אבל תנאי ההתחלה שלה שונים: <span>$latex V_{0}=2,V_{1}=a$</span>. גם לסדרה הזו יש ייצוג נחמד בתור פולינומים: <span>$latex V_{k}\triangleq x^{k}+\left(a-x\right)^{k}$</span>. אם תזכרו ש-<span>$latex U_{k}\triangleq\frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}$</span> בוודאי תראו מייד שמתקיים <span>$latex U_{k}V_{k}=U_{2k}$</span> (זה נובע מהתכונה הנחמדה <span>$latex \left(a+b\right)\left(a-b\right)=a^{2}-b^{2}$</span>), כך ששתי הסדרות הללו מקיימות ביניהם קשרים ברורים למדי.</p>

<p>בואו ננסח את מבחן ה-<span>$latex n+1$</span> בוריאציה שמערבת את ה-<span>$latex V_{k}$</span>-ים הללו: אם <span>$latex n$</span> זר ל-<span>$latex 2b$</span> ו-<span>$latex \left(\frac{\Delta}{n}\right)=-1$</span>, ניקח מחלק <strong>זוגי </strong><span>$latex F$</span> של <span>$latex n+1$</span> ונבדוק את שני התנאים הבאים:</p>
<ul>
	<li><span>$latex V_{F/2}$</span> מתחלק ב-<span>$latex n$</span>.</li>
	<li><span>$latex V_{F/2q}$</span> זר ל-<span>$latex n$</span> עבור כל <span>$latex q$</span> <strong>אי זוגי</strong> שמחלק את <span>$latex F$</span>.</li>
</ul>
<p>אז במקרה הזה קורה מה שקרה קודם - כל <span>$latex p$</span> שמחלק את <span>$latex n$</span> מקיים <span>$latex p\equiv\left(\frac{\Delta}{p}\right)$</span> מודולו <span>$latex F$</span>.</p>

<p>הניסוח הזה <strong>מושלם</strong> עבור מספרי מרסן בגלל שהתנאי השני בכלל לא יכול לבוא לידי ביטוי: אם <span>$latex F$</span> מחלק את <span>$latex n+1$</span>, שהוא חזקה של 2, אז גם <span>$latex F$</span> הוא בסך הכל חזקה של 2 ולכן אין לו גורמים אי זוגיים. בואו נסביר בזריזות למה הגרסה הזו של מבחן ה-<span>$latex n+1$</span> נכונה ואז נגיע סוף סוף להוכחת לוקאס-להמר.</p>

<p>מן הסתם אין לי כוונה להוכיח את מבחן ה-<span>$latex n+1$</span> החדש הזה מאפס - אני מבצע פה רדוקציה למבחן הקודם, עם ה-<span>$latex U_{k}$</span>-ים. ראשית, אני צריך להראות ש-<span>$latex U_{n+1}$</span> מתחלק ב-<span>$latex n$</span>. אם <span>$latex F$</span> מחלק את <span>$latex n+1$</span> יהיה מספיק להוכיח ש-<span>$latex U_{F}$</span> מתחלק ב-<span>$latex n$</span> (כי אפשר להראות שאם <span>$latex k$</span> מחלק את <span>$latex t$</span> אז <span>$latex U_{k}$</span> מחלק את <span>$latex U_{t}$</span>). מכיוון ש-<span>$latex U_{F}=U_{F/2}V_{F/2}$</span> ומכיוון שאנחנו מניחים ש-<span>$latex V_{F/2}$</span> מתחלק ב-<span>$latex n$</span>, יש לנו את התנאי הזה.</p>

<p>התנאי השני של מבחן ה-<span>$latex n+1$</span> המקורי הוא ש-<span>$latex U_{\frac{n+1}{q}}$</span> זר ל-<span>$latex n$</span> עבור כל מחלק ראשוני <span>$latex q$</span> של <span>$latex F$</span>. בשביל זה מספיק להראות ש-<span>$latex U_{\frac{F}{2q}}$</span> זר ל-<span>$latex n$</span> (כי <span>$latex U_{\frac{F}{2q}}$</span> מחלק את <span>$latex U_{\frac{n+1}{q}}$</span>), ובשביל זה מספיק להראות ש-<span>$latex U_{F/2}$</span> זר ל-<span>$latex n$</span>. שימו לב שאנחנו כבר יודעים ש-<span>$latex V_{F/2}$</span> לא רק שהוא לא זר ל-<span>$latex n$</span> אלא שהוא ממש מתחלק בו, כלומר <strong>כל</strong> מחלק של <span>$latex n$</span> מחלק את <span>$latex V_{F/2}$</span>. לכן כדי לסיים את זה מספיק להוכיח שלכל <span>$latex k$</span>, אין ל-<span>$latex U_{k},V_{k}$</span> בו זמנית מחלקים משותפים שהם גם מחלקים של <span>$latex n$</span>. ליתר דיוק, נראה שכל מחלק משותף כזה חייב לחלק את <span>$latex 2b$</span>, ונשתמש בהנחה שלנו ש-<span>$latex 2b$</span> זר ל-<span>$latex n$</span>.</p>

<p>הנימוק עכשיו חוזר להגדרה הבסיסית של <span>$latex U_{k},V_{k}$</span>. נניח ש-<span>$latex p$</span> הוא מחלק ראשוני של <span>$latex n$</span> שמחלק בו זמנית את <span>$latex U_{k}$</span> ואת <span>$latex V_{k}$</span>. אז יש לנו את שתי המשוואות הבאות מודולו <span>$latex p$</span> (ומודולו <span>$latex f\left(x\right)$</span> אבל מי זוכר את זה): <span>$latex \frac{x^{k}-\left(a-x\right)^{k}}{x-\left(a-x\right)}=0$</span> ו-<span>$latex x^{k}+\left(a-x\right)^{k}=0$</span>. מהראשונה נקבל את <span>$latex x^{k}-\left(a-x\right)^{k}=0$</span> ואחרי שנחבר את שתיהן נקבל <span>$latex 2x^{k}=0$</span>. אפשר לצמצם פה ב-2 כי הוא זר ל-<span>$latex p$</span>, ולכן נקבל <span>$latex x^{k}=0$</span>. איך זה קשור ל-<span>$latex b$</span>? ובכן, <span>$latex b=x\left(a-x\right)$</span> מודולו <span>$latex f\left(x\right)$</span> (כי <span>$latex f\left(x\right)$</span> הוא הפולינום <span>$latex x^{2}-ax+b$</span>) ולכן <span>$latex b^{k}=x^{k}\left(a-x\right)^{k}=0$</span> מודולו <span>$latex f\left(x\right)$</span> ו-<span>$latex p$</span>. בפרט, <span>$latex p$</span> מחלק את <span>$latex b^{k}$</span> ולכן הוא מחלק את <span>$latex b$</span> וסיימנו.</p>

<p>אנחנו ממש בסיום. הראינו וריאציה למבחן ה-<span>$latex n+1$</span> שמשתמשת בסדרת ה-<span>$latex V$</span>-ים במקום בסדרת ה-<span>$latex U$</span>-ים. עכשיו נבחן מה קורה כשאנחנו משתמשים במבחן הזה ספציפית על מספרי מרסן. במקרה הזה, <span>$latex n=M_{p}=2^{p}-1$</span> עבור <span>$latex p$</span> ראשוני כלשהו. כמו כן, אנחנו צריכים להחליט על <span>$latex f\left(x\right)$</span> קונקרטי שנבנה את המבחן סביבו - מה שיוצא טוב במקרה הזה הוא <span>$latex f\left(x\right)=x^{2}-4x+1$</span>, דהיינו <span>$latex a=4,b=1$</span>, ולכן <span>$latex \Delta=a^{2}-4b=12$</span>. האם <span>$latex n$</span> זר ל-<span>$latex 2\Delta=24$</span>? הוא בוודאי לא זוגי, אבל אולי הוא מתחלק ב-3? ובכן, לא: 2 בחזקת מספר אי זוגי שקול תמיד ל-2 מודולו 3 ולכן חזקה של 2 פחות 1 שקולה ל-1 מודולו 3. זה מראה ש-<span>$latex n$</span> זר ל-<span>$latex \Delta$</span>. עדיין צריך להשתכנע ש-<span>$latex \left(\frac{\Delta}{n}\right)=-1$</span> כדי שאפשר יהיה להשתמש במבחן. חישוב של סימן יעקובי שכזה הוא עניין סטנדרטי למדי שלא אוכיח את פרטיו פה: הרעיון הוא ש-<span>$latex \left(\frac{\Delta}{n}\right)=\left(\frac{24}{n}\right)=\left(\frac{2}{n}\right)\left(\frac{4}{n}\right)\left(\frac{3}{n}\right)=\left(\frac{2}{n}\right)\left(\frac{3}{n}\right)$</span> ועכשיו אפשר לטפל בנפרד במוכפלים. ידוע ש-<span>$latex \left(\frac{2}{n}\right)=1$</span> אם <span>$latex n$</span> שקול ל-7 מודולו <span>$latex 8$</span> (וזה יהיה המקרה פה כי <span>$latex n+1$</span> הוא חזקה גבוהה של 2 ולכן מתחלק ב-8). עבור <span>$latex \left(\frac{3}{n}\right)$</span> צריך להשתמש במשפט ההדדיות: <span>$latex \left(\frac{3}{n}\right)=-\left(\frac{n}{3}\right)$</span> (המינוס נובע מכך שגם ה-3 שב”מונה” וגם ה-<span>$latex n$</span> שב”מכנה” הם שניהם 3 מודולו 4). כעת, אפשר להחליף את <span>$latex n$</span> שב”מונה” במספר ששקול לו מודולו 3, שהוא כאמור 2, ואנחנו יודעים ש-2 איננו שארית ריבועית מודולו 3, ולכן נקבל פה <span>$latex -\left(\frac{n}{3}\right)=-\left(-1\right)=1$</span> בסופו של דבר.</p>

<p>עכשיו נותר לבחור מחלק זוגי <span>$latex F$</span> של <span>$latex n+1$</span> כדי להפעיל עליו את המבחן. משתלם לבחור כאן את <span>$latex 2^{p-1}$</span>. עם הבחירה הזו, התנאי הראשון של המבחן שיש לבדוק הוא ש-<span>$latex V_{2^{p-2}}$</span> מתחלק ב-<span>$latex M_{p}$</span>. והתנאי השני? הוא נעלם, כי הוא מערב מחלקים אי זוגיים של <span>$latex F$</span> ואין כאלו.</p>

<p>נותרנו, אם כן, עם השאלה איך אפשר לחשב את <span>$latex V_{2^{p-2}}$</span>. כאן סוף סוף נכנסת לתמונה <strong>סדרת לוקאס-להמר</strong> מתחילת הפוסט. זו שהוגדרה באמצעות הכלל <span>$latex a_{0}=4$</span> ו-<span>$latex a_{n+1}=a_{n}^{2}-2$</span>. זו פשוט <span>$latex V_{k}$</span> עם הפולינום המגדיר <span>$latex x^{2}-4x+1$</span> בתחפושת, כשאנחנו מתקדמים ב”קפיצות” וכל פעם מכפילים את האינדקס שלנו. קל לראות את זה מההגדרה ה”פולינומית” של <span>$latex V_{k}$</span>:</p>

<p><span>$latex V_{2k}=x^{2k}+\left(4-x\right)^{2k}=\left(x^{k}+\left(4-x\right)^{k}\right)^{2}-2x^{k}\left(4-x\right)^{k}\equiv V_{k}^{2}-2$</span></p>

<p>כאשר המעבר האחרון הוא מודולו <span>$latex f\left(x\right)=x^{2}-4x+1$</span> (מה שחוקי לעשות כי כל הסדרה מוגדרת מודולו הפולינום הזה מלכתחילה).</p>

<p>גם את תנאי ההתחלה קל להבין כעת: אמרנו ש-<span>$latex V_{0}=2$</span> ו-<span>$latex V_{1}=a$</span>, ובמקרה שלנו <span>$latex V_{1}=4$</span>. כלומר, הסדרה <span>$latex a_{n}$</span> <strong>באמת</strong> מוגדרת בתור <span>$latex a_{0}=V_{1}$</span> ובאופן כללי, <span>$latex a_{n}=V_{2^{n}}$</span>. לכן <span>$latex a_{p-2}$</span> הוא בדיוק <span>$latex V_{2^{p-2}}$</span> שלנו, כמבוקש.</p>

<p>האם סיימנו? לא! עדיין לא! זאת מכיוון שראינו רק כיוון אחד: מבחן ה-<span>$latex n+1$</span> מוכיח רק ש<strong>אם</strong> <span>$latex n$</span> עובר אותו, אז <span>$latex n$</span> ראשוני. אבל זה עדיין לא מוכיח שאם <span>$latex n$</span> ראשוני אז בהכרח הוא יעבור את המבחן. במילים אחרות, אנחנו עדיין צריכים להראות שאם <span>$latex M_{p}$</span> ראשוני אז <span>$latex a_{p-2}$</span> יתחלק על ידו. זה דומה באופי שלו למבחן הפיבונאצ’י מתחילת הפוסט, וגם ההוכחה די דומה.</p>

<p>נניח אם כן ש-<span>$latex n$</span> הוא אכן ראשוני. כבר ראינו קודם ש-<span>$latex \left(\frac{\Delta}{n}\right)=-1$</span> במקרה הנוכחי, ולכן כשמסתכלים על חוג הפולינומים מודולו <span>$latex n$</span> ו-<span>$latex f\left(x\right)$</span> מקבלים שדה סופי עם <span>$latex n^{2}$</span> איברים (זה דומה למה שהלך בהוכחה של פיבונאצ’י). בשדה כזה, כפי שראינו קודם, מתקיים <span>$latex x^{n}=4-x$</span>. עכשיו נבצע להטוט אלגברי שמטרתו לחשב את <span>$latex \left(x-1\right)^{n+1}$</span> בשתי דרכים שונות. החישובים שלנו יתבצעו כולם בתוך השדה, כלומר אני אעשה הכל מודולו <span>$latex n$</span> ומודולו <span>$latex f\left(x\right)$</span> (דהיינו תוך שימוש בשוויון <span>$latex x^{2}=4x-1$</span>) בלי להזכיר זאת אפילו. כעת:</p>

<p><span>$latex \left(x-1\right)^{2}=x^{2}-2x+1=2x$</span></p>

<p>ולכן:</p>

<p><span>$latex \left(x-1\right)^{n+1}=\left(2x\right)^{\frac{n+1}{2}}=2\cdot2^{\frac{n-1}{2}}x^{\frac{n+1}{2}}$</span></p>

<p>אני רוצה לנטרל את ה-<span>$latex 2^{\frac{n-1}{2}}$</span> הזה שבאמצע ולטעון שהוא שווה ל-1 (מודולו <span>$latex n$</span>); זו עוד תוצאה סטנדרטית על שאריות ריבועיות שלא אוכיח כרגע (לכל מספר <span>$latex a$</span> וראשוני <span>$latex p$</span> מתקיים ש-<span>$latex \left(\frac{a}{p}\right)=a^{\frac{p-1}{2}}$</span> מודולו <span>$latex p$</span>). קיבלנו, אם כן, את השוויון</p>

<p><span>$latex \left(x-1\right)^{n+1}=2x^{\frac{n+1}{2}}$</span></p>

<p>עכשיו לחישוב בדרך השניה. אני הולך להתבסס על כך ש-<span>$latex \left(a+b\right)^{n}=a^{n}+b^{n}$</span> מודולו <span>$latex n$</span> (זה נכון רק כש-<span>$latex n$</span> ראשוני, כמו במקרה שלנו) ולכן <span>$latex \left(x-1\right)^{n}=x^{n}+\left(-1\right)^{n}=x^{n}-1$</span> (המעבר האחרון נכון רק כש-<span>$latex n$</span> אי זוגי, כמו במקרה שלנו) ועל מה שהזכרתי לפני רגע, ש-<span>$latex x^{n}=4-x$</span>:</p>

<p><span>$latex \left(x-1\right)^{n+1}=\left(x-1\right)\left(x-1\right)^{n}=\left(x-1\right)\left(x^{n}-1\right)=\left(x-1\right)\left(3-x\right)=4x-x^{2}-3=-2$</span></p>

<p>ולכן קיבלנו:</p>

<p><span>$latex 2x^{\frac{n+1}{2}}=-2$</span></p>

<p>כלומר:</p>

<p><span>$latex x^{\frac{n+1}{2}}=-1$</span>.</p>

<p>בואו ניזכר עכשיו מה זה <span>$latex n$</span>: זה <span>$latex n=2^{p}-1$</span>, כלומר <span>$latex \frac{n+1}{2}=2^{p-1}$</span>. לכן קיבלנו <span>$latex x^{2^{p-1}}=-1$</span>. את כל העסק הזה אפשר להעלות בחזקת <span>$latex n$</span> כדי להפוך את ה-<span>$latex x$</span> ל-<span>$latex 4-x$</span>; אגף ימין לא ישתנה כי <span>$latex n$</span> אי-זוגי. נקבל <span>$latex \left(4-x\right)^{2^{p-1}}=-1$</span>. מכיוון ש-<span>$latex U_{2^{p-1}}$</span> הוא הפרש שני אלו חלקי משהו מודולו <span>$latex n$</span>, נקבל שהוא מתחלק ב-<span>$latex n$</span>. עכשיו, <span>$latex U_{2^{p-1}}=U_{2^{p-2}}V_{2^{p-2}}$</span>; מכיוון ש-<span>$latex n$</span> ראשוני, אם הוא מחלק את המכפלה שלהם הוא חייב לחלק אחד מהם. אם הוא מחלק את <span>$latex V_{2^{p-2}}$</span>, סיימנו; זה בדיוק מה שרצינו להראות. נשאר רק להשתכנע שהוא לא מחלק את <span>$latex U_{2^{p-2}}$</span>. אם הוא כן, אז נקבל את השוויון <span>$latex x^{2^{p-2}}=\left(4-x\right)^{2^{p-2}}$</span>, ועל כן:</p>

<p><span>$latex -1=x^{2^{p-1}}=x^{2^{p-2}}\cdot x^{2^{p-2}}=x^{2^{p-2}}\left(4-x\right)^{2^{p-2}}=\left(x\left(4-x\right)\right)^{2^{p-2}}=1^{2^{p-2}}=1$</span></p>

<p>וזו סתירה, כי גם מודולו <span>$latex f\left(x\right)$</span> ומודולו <span>$latex n$</span>, עדיין <span>$latex 1\ne-1$</span>, מה שמסיים את ההוכחה.</p>

<p>סוף דבר - התחלנו עם מבחן פשוט בצורה קיצונית ויעיל בצורה קיצונית. גילינו שההוכחה לא פשוטה בצורה קיצונית, אבל גם אין בה שום דבר מתוחכם במיוחד, ובדרך ראינו כל מני מבחנים למציאת פסואדוראשוניים והוכחת ראשוניות. עבורי מי שהיה נחמד פה במיוחד הוא לראות איך דברים כמו שדות סופיים, אוטומורפיזם פרובניוס ושאריות ריבועיות צצים כמעט מאליהם כשמתעסקים בנושאים הללו; כשרק לומדים אותם המושגים הללו נראים די מנותקים ולא כמו כלי העבודה המאוד בסיסי שהם.</p>

  </div>

  <hr />
  <p>
    נהניתם? התעניינתם? אם תרצו, אתם מוזמנים לתת טיפ:
  </p>
  <a href='https://ko-fi.com/H2H5XFBQ' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://az743702.vo.msecnd.net/cdn/kofi2.png?v=2' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a><div class="PageNavigation">
    
      <a class="prev" href="/2016/11/05/perfect_numbers_and_mersenne_primes/">&laquo; מספרים מושלמים וראשוניי מרסן</a>
    
    
      <a class="next" href="/2016/11/30/csb_theorem_hilbert_hotel_style/">משפט קנטור-שרדר-ברנשטיין - ועכשיו בגרסת המלון של הילברט! &raquo;</a>
    
  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://gadial.net/2016/11/22/lucas_sequences/';
      this.page.identifier = 'http://gadial.net/2016/11/22/lucas_sequences/';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://not-precise.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2016/11/22/lucas_sequences/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">לא מדויק</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">לא מדויק</li><li><a class="u-email" href="mailto:gadial@gmail.com">gadial@gmail.com</a></li><li>&copy; כל הזכויות שמורות לגדי אלכסנדרוביץ'</li>
        </ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.facebook.com/%D7%9C%D7%90-%D7%9E%D7%93%D7%95%D7%99%D7%A7-163347110378474"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#facebook"></use></svg> <span class="username">לא מדויק</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>בלוג על מתמטיקה ומדעי המחשב</p>
      </div>
    </div>

  </div>

</footer>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script>window.jQuery || document.write('<script src="assets/js/jquery-slim.min.js"><\/script>')</script><script src="/assets/js/bootstrap.bundle.js"></script><!-- Default Statcounter code for New blog
http://www.gadial.net/ -->
<script type="text/javascript">
  var sc_project=5444342; 
  var sc_invisible=1; 
  var sc_security="4a89cbe4"; 
  </script>
  <script type="text/javascript"
  src="https://www.statcounter.com/counter/counter.js"
  async></script>
  <noscript><div class="statcounter"><a title="Web Analytics"
  href="https://statcounter.com/" target="_blank"><img
  class="statcounter"
  src="https://c.statcounter.com/5444342/0/4a89cbe4/1/"
  alt="Web Analytics"></a></div></noscript>
  <!-- End of Statcounter Code --></body>

</html>
